"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/merge/route";
exports.ids = ["app/api/merge/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "sharp":
/*!************************!*\
  !*** external "sharp" ***!
  \************************/
/***/ ((module) => {

module.exports = require("sharp");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmerge%2Froute&page=%2Fapi%2Fmerge%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmerge%2Froute.ts&appDir=D%3A%5CCursor%5Cface2exchange%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCursor%5Cface2exchange&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmerge%2Froute&page=%2Fapi%2Fmerge%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmerge%2Froute.ts&appDir=D%3A%5CCursor%5Cface2exchange%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCursor%5Cface2exchange&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_node_polyfill_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/node-polyfill-headers */ \"(rsc)/./node_modules/next/dist/server/node-polyfill-headers.js\");\n/* harmony import */ var next_dist_server_node_polyfill_headers__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_node_polyfill_headers__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var D_Cursor_face2exchange_app_api_merge_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/merge/route.ts */ \"(rsc)/./app/api/merge/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_2__.RouteKind.APP_ROUTE,\n        page: \"/api/merge/route\",\n        pathname: \"/api/merge\",\n        filename: \"route\",\n        bundlePath: \"app/api/merge/route\"\n    },\n    resolvedPagePath: \"D:\\\\Cursor\\\\face2exchange\\\\app\\\\api\\\\merge\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Cursor_face2exchange_app_api_merge_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/merge/route\";\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtZXJnZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGbWVyZ2UlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZtZXJnZSUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQ3Vyc29yJTVDZmFjZTJleGNoYW5nZSU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RCUzQSU1Q0N1cnNvciU1Q2ZhY2UyZXhjaGFuZ2UmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9c3RhbmRhbG9uZSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQWdEO0FBQ3NEO0FBQ3ZDO0FBQ2tCO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ2lKOztBQUVqSiIsInNvdXJjZXMiOlsid2VicGFjazovL2ZhY2Utc3dhcC1hcHAvPzQ4ZmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwibmV4dC9kaXN0L3NlcnZlci9ub2RlLXBvbHlmaWxsLWhlYWRlcnNcIjtcbmltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkQ6XFxcXEN1cnNvclxcXFxmYWNlMmV4Y2hhbmdlXFxcXGFwcFxcXFxhcGlcXFxcbWVyZ2VcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwic3RhbmRhbG9uZVwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9tZXJnZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL21lcmdlXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9tZXJnZS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkQ6XFxcXEN1cnNvclxcXFxmYWNlMmV4Y2hhbmdlXFxcXGFwcFxcXFxhcGlcXFxcbWVyZ2VcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvbWVyZ2Uvcm91dGVcIjtcbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmerge%2Froute&page=%2Fapi%2Fmerge%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmerge%2Froute.ts&appDir=D%3A%5CCursor%5Cface2exchange%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCursor%5Cface2exchange&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/merge/route.ts":
/*!********************************!*\
  !*** ./app/api/merge/route.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n\nasync function compressImage(file) {\n    try {\n        console.log(\"开始压缩图片...\");\n        const buffer = await file.arrayBuffer();\n        const fileBuffer = Buffer.from(buffer);\n        let sharpInstance;\n        try {\n            // 尝试动态导入 sharp\n            const sharpModule = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! sharp */ \"sharp\", 23));\n            sharpInstance = sharpModule.default;\n            console.log(\"Sharp 模块加载成功\");\n        } catch (error) {\n            console.error(\"Sharp 模块加载失败:\", error);\n            // 如果无法加载 sharp，返回原图\n            return file;\n        }\n        try {\n            console.log(\"开始处理图片\");\n            const compressedBuffer = await sharpInstance(fileBuffer).resize(1920, 1920, {\n                fit: \"inside\",\n                withoutEnlargement: true\n            }).jpeg({\n                quality: 80,\n                progressive: true\n            }).toBuffer();\n            console.log(\"图片压缩完成\");\n            return new File([\n                compressedBuffer\n            ], file.name, {\n                type: \"image/jpeg\"\n            });\n        } catch (processError) {\n            console.error(\"图片处理失败:\", processError);\n            return file;\n        }\n    } catch (error) {\n        console.error(\"图片压缩过程出错:\", error);\n        // 如果压缩失败，返回原图\n        return file;\n    }\n}\nasync function uploadToImageHub(file, retryCount = 0) {\n    try {\n        const formData = new FormData();\n        formData.append(\"source\", file);\n        console.log(\"准备上传图片到图床:\", {\n            url: process.env.IMAGEHUB_API_URL,\n            method: \"POST\",\n            file: {\n                type: file.type,\n                size: `${(file.size / 1024 / 1024).toFixed(2)}MB`,\n                lastModified: file instanceof File ? new Date(file.lastModified).toISOString() : \"N/A\",\n                name: file instanceof File ? file.name : \"blob\"\n            },\n            retryCount\n        });\n        const requestHeaders = {\n            \"X-API-Key\": \"***\" + process.env.IMAGEHUB_API_KEY.slice(-6)\n        };\n        console.log(\"请求头:\", requestHeaders);\n        console.log(\"FormData 内容:\");\n        for (const [key, value] of formData.entries()){\n            console.log(\"- \", key, \":\", {\n                type: value instanceof Blob ? value.type : typeof value,\n                size: value instanceof Blob ? `${(value.size / 1024 / 1024).toFixed(2)}MB` : \"N/A\",\n                name: value instanceof File ? value.name : \"blob\"\n            });\n        }\n        const startTime = Date.now();\n        const response = await fetch(process.env.IMAGEHUB_API_URL, {\n            method: \"POST\",\n            headers: {\n                \"X-API-Key\": process.env.IMAGEHUB_API_KEY\n            },\n            body: formData\n        });\n        const endTime = Date.now();\n        console.log(\"图床响应详情:\", {\n            timing: {\n                startTime: new Date(startTime).toISOString(),\n                endTime: new Date(endTime).toISOString(),\n                duration: `${endTime - startTime}ms`\n            },\n            status: {\n                code: response.status,\n                text: response.statusText\n            },\n            headers: Object.fromEntries(response.headers.entries()),\n            type: response.type,\n            url: response.url,\n            redirected: response.redirected\n        });\n        if (!response.ok) {\n            const errorText = await response.text();\n            console.error(\"图床上传失败:\", {\n                status: response.status,\n                statusText: response.statusText,\n                responseBody: errorText,\n                timestamp: new Date().toISOString()\n            });\n            throw new Error(\"图片上传失败\");\n        }\n        const result = await response.json();\n        console.log(\"图床上传成功:\", {\n            timing: {\n                total: `${endTime - startTime}ms`,\n                timestamp: new Date().toISOString()\n            },\n            response: {\n                status_code: result.status_code,\n                status_txt: result.status_txt,\n                image: result.image\n            },\n            request: {\n                originalFile: {\n                    type: file.type,\n                    size: `${(file.size / 1024 / 1024).toFixed(2)}MB`,\n                    name: file instanceof File ? file.name : \"blob\"\n                }\n            }\n        });\n        if (result.status_code !== 200) {\n            console.error(\"图床返回错误:\", {\n                result,\n                timestamp: new Date().toISOString(),\n                requestDetails: {\n                    fileType: file.type,\n                    fileSize: `${(file.size / 1024 / 1024).toFixed(2)}MB`\n                }\n            });\n            throw new Error(result.status_txt || \"图片上传失败\");\n        }\n        return result.image.url;\n    } catch (error) {\n        if (retryCount < 2) {\n            console.log(`上传失败，准备重试 (第${retryCount + 1}次):`, {\n                error: error instanceof Error ? error.message : String(error),\n                nextAction: \"尝试压缩后重新上传\",\n                timestamp: new Date().toISOString(),\n                fileInfo: {\n                    type: file.type,\n                    size: `${(file.size / 1024 / 1024).toFixed(2)}MB`,\n                    name: file instanceof File ? file.name : \"blob\"\n                }\n            });\n            const compressedFile = await compressImage(file instanceof File ? file : new File([\n                file\n            ], \"image.jpg\"));\n            return uploadToImageHub(compressedFile, retryCount + 1);\n        }\n        console.error(\"图片上传最终失败:\", {\n            error: error instanceof Error ? error.message : String(error),\n            stack: error instanceof Error ? error.stack : undefined,\n            retryCount,\n            timestamp: new Date().toISOString(),\n            fileDetails: {\n                type: file.type,\n                size: `${(file.size / 1024 / 1024).toFixed(2)}MB`,\n                name: file instanceof File ? file.name : \"blob\"\n            }\n        });\n        throw error;\n    }\n}\nasync function fetchWithRetry(url, options, retries = 3, delay = 1000) {\n    let lastError = new Error(\"Unknown error\");\n    for(let attempt = 0; attempt < retries; attempt++){\n        try {\n            const response = await fetch(url, options);\n            if (response.ok) return response;\n            const errorText = await response.text();\n            throw new Error(`HTTP error! status: ${response.status} - ${errorText}`);\n        } catch (error) {\n            lastError = error instanceof Error ? error : new Error(String(error));\n            console.log(`请求失败，第 ${attempt + 1} 次重试:`, {\n                error: lastError.message,\n                nextRetryIn: attempt < retries - 1 ? `${delay}ms` : \"no more retries\",\n                url,\n                timestamp: new Date().toISOString()\n            });\n            if (attempt < retries - 1) {\n                await new Promise((resolve)=>setTimeout(resolve, delay));\n                continue;\n            }\n        }\n    }\n    throw lastError;\n}\nasync function downloadAndUploadImage(url) {\n    try {\n        console.log(\"开始下载图片:\", url);\n        const controller = new AbortController();\n        const timeout = setTimeout(()=>controller.abort(), 30000);\n        const response = await fetchWithRetry(url, {\n            signal: controller.signal,\n            headers: {\n                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\",\n                \"Accept\": \"image/*, */*\",\n                \"Accept-Encoding\": \"gzip, deflate, br\",\n                \"Connection\": \"keep-alive\"\n            },\n            keepalive: true\n        }, 3, 1000 // 重试延迟\n        ).finally(()=>clearTimeout(timeout));\n        if (!response.ok) {\n            console.error(\"图片下载失败:\", {\n                status: response.status,\n                statusText: response.statusText,\n                headers: Object.fromEntries(response.headers.entries())\n            });\n            throw new Error(`图片下载失败: ${response.status} ${response.statusText}`);\n        }\n        const contentType = response.headers.get(\"content-type\");\n        if (!contentType?.startsWith(\"image/\")) {\n            console.error(\"响应不是图片:\", contentType);\n            throw new Error(\"下载的内容不是图片\");\n        }\n        const blob = await response.blob();\n        console.log(\"图片下载完成\", {\n            size: `${(blob.size / 1024 / 1024).toFixed(2)}MB`,\n            type: blob.type\n        });\n        return await uploadToImageHub(blob);\n    } catch (error) {\n        console.error(\"下载并上传图片失败:\", {\n            error: error instanceof Error ? error.message : String(error),\n            stack: error instanceof Error ? error.stack : undefined,\n            url,\n            timestamp: new Date().toISOString()\n        });\n        throw error;\n    }\n}\nasync function POST(request) {\n    try {\n        // 1. 环境变量验证\n        const requiredEnvVars = [\n            \"WORKFLOW_ID\",\n            \"COZE_API_URL\",\n            \"AUTHORIZATION\",\n            \"IMAGEHUB_API_URL\",\n            \"IMAGEHUB_API_KEY\"\n        ];\n        const missingVars = requiredEnvVars.filter((key)=>!process.env[key]);\n        if (missingVars.length > 0) {\n            console.error(\"缺少环境变量:\", missingVars);\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                error: `配置错误: 缺少环境变量 ${missingVars.join(\", \")}`,\n                errorType: \"ConfigError\"\n            }), {\n                status: 500,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        // 2. 请求验证\n        const formData = await request.formData().catch((error)=>{\n            console.error(\"解析表单数据失败:\", error);\n            return null;\n        });\n        if (!formData) {\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                error: \"无效的请求数据\",\n                errorType: \"ValidationError\"\n            }), {\n                status: 400,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        const image1 = formData.get(\"image1\");\n        const image2 = formData.get(\"image2\");\n        if (!image1 || !image2) {\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                error: \"请提供两张图片\",\n                errorType: \"ValidationError\"\n            }), {\n                status: 400,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        // 3. 图片处理\n        try {\n            console.log(\"开始上传原始图片...\");\n            const [image1Url, image2Url] = await Promise.all([\n                uploadToImageHub(image1),\n                uploadToImageHub(image2)\n            ]);\n            // 4. 调用 Coze API\n            console.log(\"调用 Coze API...\");\n            const cozeResponse = await fetch(process.env.COZE_API_URL, {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Bearer ${process.env.AUTHORIZATION.trim()}`,\n                    \"Content-Type\": \"application/json\",\n                    \"Accept\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    workflow_id: process.env.WORKFLOW_ID.trim(),\n                    parameters: {\n                        face_image: image1Url,\n                        base_image: image2Url\n                    }\n                })\n            });\n            if (!cozeResponse.ok) {\n                const errorText = await cozeResponse.text();\n                console.error(\"Coze API 错误响应:\", errorText);\n                return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                    error: \"AI 处理失败\",\n                    errorType: \"CozeAPIError\",\n                    details: errorText\n                }), {\n                    status: 502,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            }\n            const cozeResult = await cozeResponse.json();\n            if (cozeResult.code !== 0) {\n                return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                    error: cozeResult.msg || \"AI 处理失败\",\n                    errorType: \"CozeAPIError\",\n                    details: cozeResult\n                }), {\n                    status: 502,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            }\n            // 5. 处理返回的图片\n            const outputData = typeof cozeResult.data === \"string\" ? JSON.parse(cozeResult.data) : cozeResult.data;\n            if (!outputData?.output) {\n                return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                    error: \"处理结果无效\",\n                    errorType: \"ProcessError\",\n                    details: cozeResult\n                }), {\n                    status: 500,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            }\n            // 6. 上传结果图片到图床\n            const finalImageUrl = await downloadAndUploadImage(outputData.output);\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                resultUrl: finalImageUrl,\n                originalUrl: outputData.output,\n                rawResponse: cozeResult\n            }), {\n                status: 200,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        } catch (error) {\n            console.error(\"处理过程错误:\", {\n                error: error instanceof Error ? error.message : String(error),\n                stack: error instanceof Error ? error.stack : undefined,\n                timestamp: new Date().toISOString(),\n                details: error instanceof Error ? error.cause : undefined\n            });\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                error: error instanceof Error ? error.message : \"处理失败\",\n                errorType: \"ProcessError\",\n                details: error instanceof Error ? error.stack : undefined\n            }), {\n                status: 500,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n    } catch (error) {\n        // 最外层错误处理\n        console.error(\"API 致命错误:\", error);\n        return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n            error: \"服务器内部错误\",\n            errorType: \"ServerError\",\n            details: error instanceof Error ? error.stack : undefined\n        }), {\n            status: 500,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL21lcmdlL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXVEO0FBR3ZELGVBQWVDLGNBQWNDLElBQVU7SUFDckMsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUM7UUFDWixNQUFNQyxTQUFTLE1BQU1ILEtBQUtJLFdBQVc7UUFDckMsTUFBTUMsYUFBYUMsT0FBT0MsSUFBSSxDQUFDSjtRQUUvQixJQUFJSztRQUNKLElBQUk7WUFDRixlQUFlO1lBQ2YsTUFBTUMsY0FBYyxNQUFNLGdIQUFPO1lBQ2pDRCxnQkFBZ0JDLFlBQVlDLE9BQU87WUFDbkNULFFBQVFDLEdBQUcsQ0FBQztRQUNkLEVBQUUsT0FBT1MsT0FBTztZQUNkVixRQUFRVSxLQUFLLENBQUMsaUJBQWlCQTtZQUMvQixvQkFBb0I7WUFDcEIsT0FBT1g7UUFDVDtRQUVBLElBQUk7WUFDRkMsUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTVUsbUJBQW1CLE1BQU1KLGNBQWNILFlBQzFDUSxNQUFNLENBQUMsTUFBTSxNQUFNO2dCQUNsQkMsS0FBSztnQkFDTEMsb0JBQW9CO1lBQ3RCLEdBQ0NDLElBQUksQ0FBQztnQkFDSkMsU0FBUztnQkFDVEMsYUFBYTtZQUNmLEdBQ0NDLFFBQVE7WUFFWGxCLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU8sSUFBSWtCLEtBQUs7Z0JBQUNSO2FBQWlCLEVBQUVaLEtBQUtxQixJQUFJLEVBQUU7Z0JBQUVDLE1BQU07WUFBYTtRQUN0RSxFQUFFLE9BQU9DLGNBQWM7WUFDckJ0QixRQUFRVSxLQUFLLENBQUMsV0FBV1k7WUFDekIsT0FBT3ZCO1FBQ1Q7SUFDRixFQUFFLE9BQU9XLE9BQU87UUFDZFYsUUFBUVUsS0FBSyxDQUFDLGFBQWFBO1FBQzNCLGNBQWM7UUFDZCxPQUFPWDtJQUNUO0FBQ0Y7QUFFQSxlQUFld0IsaUJBQWlCeEIsSUFBaUIsRUFBRXlCLGFBQWEsQ0FBQztJQUMvRCxJQUFJO1FBQ0YsTUFBTUMsV0FBVyxJQUFJQztRQUNyQkQsU0FBU0UsTUFBTSxDQUFDLFVBQVU1QjtRQUUxQkMsUUFBUUMsR0FBRyxDQUFDLGNBQWM7WUFDeEIyQixLQUFLQyxRQUFRQyxHQUFHLENBQUNDLGdCQUFnQjtZQUNqQ0MsUUFBUTtZQUNSakMsTUFBTTtnQkFDSnNCLE1BQU10QixLQUFLc0IsSUFBSTtnQkFDZlksTUFBTSxDQUFDLEVBQUUsQ0FBQ2xDLEtBQUtrQyxJQUFJLEdBQUcsT0FBTyxJQUFHLEVBQUdDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsQ0FBQztnQkFDakRDLGNBQWNwQyxnQkFBZ0JvQixPQUFPLElBQUlpQixLQUFLckMsS0FBS29DLFlBQVksRUFBRUUsV0FBVyxLQUFLO2dCQUNqRmpCLE1BQU1yQixnQkFBZ0JvQixPQUFPcEIsS0FBS3FCLElBQUksR0FBRztZQUMzQztZQUNBSTtRQUNGO1FBRUEsTUFBTWMsaUJBQWlCO1lBQ3JCLGFBQWEsUUFBUVQsUUFBUUMsR0FBRyxDQUFDUyxnQkFBZ0IsQ0FBRUMsS0FBSyxDQUFDLENBQUM7UUFDNUQ7UUFDQXhDLFFBQVFDLEdBQUcsQ0FBQyxRQUFRcUM7UUFFcEJ0QyxRQUFRQyxHQUFHLENBQUM7UUFDWixLQUFLLE1BQU0sQ0FBQ3dDLEtBQUtDLE1BQU0sSUFBSWpCLFNBQVNrQixPQUFPLEdBQUk7WUFDN0MzQyxRQUFRQyxHQUFHLENBQUMsTUFBTXdDLEtBQUssS0FBSztnQkFDMUJwQixNQUFNcUIsaUJBQWlCRSxPQUFPRixNQUFNckIsSUFBSSxHQUFHLE9BQU9xQjtnQkFDbERULE1BQU1TLGlCQUFpQkUsT0FBTyxDQUFDLEVBQUUsQ0FBQ0YsTUFBTVQsSUFBSSxHQUFHLE9BQU8sSUFBRyxFQUFHQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRztnQkFDN0VkLE1BQU1zQixpQkFBaUJ2QixPQUFPdUIsTUFBTXRCLElBQUksR0FBRztZQUM3QztRQUNGO1FBRUEsTUFBTXlCLFlBQVlULEtBQUtVLEdBQUc7UUFDMUIsTUFBTUMsV0FBVyxNQUFNQyxNQUFNbkIsUUFBUUMsR0FBRyxDQUFDQyxnQkFBZ0IsRUFBRztZQUMxREMsUUFBUTtZQUNSaUIsU0FBUztnQkFDUCxhQUFhcEIsUUFBUUMsR0FBRyxDQUFDUyxnQkFBZ0I7WUFDM0M7WUFDQVcsTUFBTXpCO1FBQ1I7UUFFQSxNQUFNMEIsVUFBVWYsS0FBS1UsR0FBRztRQUV4QjlDLFFBQVFDLEdBQUcsQ0FBQyxXQUFXO1lBQ3JCbUQsUUFBUTtnQkFDTlAsV0FBVyxJQUFJVCxLQUFLUyxXQUFXUixXQUFXO2dCQUMxQ2MsU0FBUyxJQUFJZixLQUFLZSxTQUFTZCxXQUFXO2dCQUN0Q2dCLFVBQVUsQ0FBQyxFQUFFRixVQUFVTixVQUFVLEVBQUUsQ0FBQztZQUN0QztZQUNBUyxRQUFRO2dCQUNOQyxNQUFNUixTQUFTTyxNQUFNO2dCQUNyQkUsTUFBTVQsU0FBU1UsVUFBVTtZQUMzQjtZQUNBUixTQUFTUyxPQUFPQyxXQUFXLENBQUNaLFNBQVNFLE9BQU8sQ0FBQ04sT0FBTztZQUNwRHRCLE1BQU0wQixTQUFTMUIsSUFBSTtZQUNuQk8sS0FBS21CLFNBQVNuQixHQUFHO1lBQ2pCZ0MsWUFBWWIsU0FBU2EsVUFBVTtRQUNqQztRQUVBLElBQUksQ0FBQ2IsU0FBU2MsRUFBRSxFQUFFO1lBQ2hCLE1BQU1DLFlBQVksTUFBTWYsU0FBU1MsSUFBSTtZQUNyQ3hELFFBQVFVLEtBQUssQ0FBQyxXQUFXO2dCQUN2QjRDLFFBQVFQLFNBQVNPLE1BQU07Z0JBQ3ZCRyxZQUFZVixTQUFTVSxVQUFVO2dCQUMvQk0sY0FBY0Q7Z0JBQ2RFLFdBQVcsSUFBSTVCLE9BQU9DLFdBQVc7WUFDbkM7WUFDQSxNQUFNLElBQUk0QixNQUFNO1FBQ2xCO1FBRUEsTUFBTUMsU0FBUyxNQUFNbkIsU0FBU29CLElBQUk7UUFDbENuRSxRQUFRQyxHQUFHLENBQUMsV0FBVztZQUNyQm1ELFFBQVE7Z0JBQ05nQixPQUFPLENBQUMsRUFBRWpCLFVBQVVOLFVBQVUsRUFBRSxDQUFDO2dCQUNqQ21CLFdBQVcsSUFBSTVCLE9BQU9DLFdBQVc7WUFDbkM7WUFDQVUsVUFBVTtnQkFDUnNCLGFBQWFILE9BQU9HLFdBQVc7Z0JBQy9CQyxZQUFZSixPQUFPSSxVQUFVO2dCQUM3QkMsT0FBT0wsT0FBT0ssS0FBSztZQUNyQjtZQUNBQyxTQUFTO2dCQUNQQyxjQUFjO29CQUNacEQsTUFBTXRCLEtBQUtzQixJQUFJO29CQUNmWSxNQUFNLENBQUMsRUFBRSxDQUFDbEMsS0FBS2tDLElBQUksR0FBRyxPQUFPLElBQUcsRUFBR0MsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDO29CQUNqRGQsTUFBTXJCLGdCQUFnQm9CLE9BQU9wQixLQUFLcUIsSUFBSSxHQUFHO2dCQUMzQztZQUNGO1FBQ0Y7UUFFQSxJQUFJOEMsT0FBT0csV0FBVyxLQUFLLEtBQUs7WUFDOUJyRSxRQUFRVSxLQUFLLENBQUMsV0FBVztnQkFDdkJ3RDtnQkFDQUYsV0FBVyxJQUFJNUIsT0FBT0MsV0FBVztnQkFDakNxQyxnQkFBZ0I7b0JBQ2RDLFVBQVU1RSxLQUFLc0IsSUFBSTtvQkFDbkJ1RCxVQUFVLENBQUMsRUFBRSxDQUFDN0UsS0FBS2tDLElBQUksR0FBRyxPQUFPLElBQUcsRUFBR0MsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDO2dCQUN2RDtZQUNGO1lBQ0EsTUFBTSxJQUFJK0IsTUFBTUMsT0FBT0ksVUFBVSxJQUFJO1FBQ3ZDO1FBRUEsT0FBT0osT0FBT0ssS0FBSyxDQUFDM0MsR0FBRztJQUN6QixFQUFFLE9BQU9sQixPQUFPO1FBQ2QsSUFBSWMsYUFBYSxHQUFHO1lBQ2xCeEIsUUFBUUMsR0FBRyxDQUFDLENBQUMsWUFBWSxFQUFFdUIsYUFBYSxFQUFFLEdBQUcsQ0FBQyxFQUFFO2dCQUM5Q2QsT0FBT0EsaUJBQWlCdUQsUUFBUXZELE1BQU1tRSxPQUFPLEdBQUdDLE9BQU9wRTtnQkFDdkRxRSxZQUFZO2dCQUNaZixXQUFXLElBQUk1QixPQUFPQyxXQUFXO2dCQUNqQzJDLFVBQVU7b0JBQ1IzRCxNQUFNdEIsS0FBS3NCLElBQUk7b0JBQ2ZZLE1BQU0sQ0FBQyxFQUFFLENBQUNsQyxLQUFLa0MsSUFBSSxHQUFHLE9BQU8sSUFBRyxFQUFHQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUM7b0JBQ2pEZCxNQUFNckIsZ0JBQWdCb0IsT0FBT3BCLEtBQUtxQixJQUFJLEdBQUc7Z0JBQzNDO1lBQ0Y7WUFDQSxNQUFNNkQsaUJBQWlCLE1BQU1uRixjQUFjQyxnQkFBZ0JvQixPQUFPcEIsT0FBTyxJQUFJb0IsS0FBSztnQkFBQ3BCO2FBQUssRUFBRTtZQUMxRixPQUFPd0IsaUJBQWlCMEQsZ0JBQWdCekQsYUFBYTtRQUN2RDtRQUNBeEIsUUFBUVUsS0FBSyxDQUFDLGFBQWE7WUFDekJBLE9BQU9BLGlCQUFpQnVELFFBQVF2RCxNQUFNbUUsT0FBTyxHQUFHQyxPQUFPcEU7WUFDdkR3RSxPQUFPeEUsaUJBQWlCdUQsUUFBUXZELE1BQU13RSxLQUFLLEdBQUdDO1lBQzlDM0Q7WUFDQXdDLFdBQVcsSUFBSTVCLE9BQU9DLFdBQVc7WUFDakMrQyxhQUFhO2dCQUNYL0QsTUFBTXRCLEtBQUtzQixJQUFJO2dCQUNmWSxNQUFNLENBQUMsRUFBRSxDQUFDbEMsS0FBS2tDLElBQUksR0FBRyxPQUFPLElBQUcsRUFBR0MsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDO2dCQUNqRGQsTUFBTXJCLGdCQUFnQm9CLE9BQU9wQixLQUFLcUIsSUFBSSxHQUFHO1lBQzNDO1FBQ0Y7UUFDQSxNQUFNVjtJQUNSO0FBQ0Y7QUFFQSxlQUFlMkUsZUFDYnpELEdBQVcsRUFDWDBELE9BQW9CLEVBQ3BCQyxVQUFVLENBQUMsRUFDWEMsUUFBUSxJQUFJO0lBRVosSUFBSUMsWUFBbUIsSUFBSXhCLE1BQU07SUFFakMsSUFBSyxJQUFJeUIsVUFBVSxHQUFHQSxVQUFVSCxTQUFTRyxVQUFXO1FBQ2xELElBQUk7WUFDRixNQUFNM0MsV0FBVyxNQUFNQyxNQUFNcEIsS0FBSzBEO1lBQ2xDLElBQUl2QyxTQUFTYyxFQUFFLEVBQUUsT0FBT2Q7WUFFeEIsTUFBTWUsWUFBWSxNQUFNZixTQUFTUyxJQUFJO1lBQ3JDLE1BQU0sSUFBSVMsTUFBTSxDQUFDLG9CQUFvQixFQUFFbEIsU0FBU08sTUFBTSxDQUFDLEdBQUcsRUFBRVEsVUFBVSxDQUFDO1FBQ3pFLEVBQUUsT0FBT3BELE9BQU87WUFDZCtFLFlBQVkvRSxpQkFBaUJ1RCxRQUFRdkQsUUFBUSxJQUFJdUQsTUFBTWEsT0FBT3BFO1lBQzlEVixRQUFRQyxHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUV5RixVQUFVLEVBQUUsS0FBSyxDQUFDLEVBQUU7Z0JBQ3hDaEYsT0FBTytFLFVBQVVaLE9BQU87Z0JBQ3hCYyxhQUFhRCxVQUFVSCxVQUFVLElBQUksQ0FBQyxFQUFFQyxNQUFNLEVBQUUsQ0FBQyxHQUFHO2dCQUNwRDVEO2dCQUNBb0MsV0FBVyxJQUFJNUIsT0FBT0MsV0FBVztZQUNuQztZQUVBLElBQUlxRCxVQUFVSCxVQUFVLEdBQUc7Z0JBQ3pCLE1BQU0sSUFBSUssUUFBUUMsQ0FBQUEsVUFBV0MsV0FBV0QsU0FBU0w7Z0JBQ2pEO1lBQ0Y7UUFDRjtJQUNGO0lBRUEsTUFBTUM7QUFDUjtBQUVBLGVBQWVNLHVCQUF1Qm5FLEdBQVc7SUFDL0MsSUFBSTtRQUNGNUIsUUFBUUMsR0FBRyxDQUFDLFdBQVcyQjtRQUV2QixNQUFNb0UsYUFBYSxJQUFJQztRQUN2QixNQUFNQyxVQUFVSixXQUFXLElBQU1FLFdBQVdHLEtBQUssSUFBSTtRQUVyRCxNQUFNcEQsV0FBVyxNQUFNc0MsZUFDckJ6RCxLQUNBO1lBQ0V3RSxRQUFRSixXQUFXSSxNQUFNO1lBQ3pCbkQsU0FBUztnQkFDUCxjQUFjO2dCQUNkLFVBQVU7Z0JBQ1YsbUJBQW1CO2dCQUNuQixjQUFjO1lBQ2hCO1lBQ0FvRCxXQUFXO1FBQ2IsR0FDQSxHQUNBLEtBQUssT0FBTztVQUNaQyxPQUFPLENBQUMsSUFBTUMsYUFBYUw7UUFFN0IsSUFBSSxDQUFDbkQsU0FBU2MsRUFBRSxFQUFFO1lBQ2hCN0QsUUFBUVUsS0FBSyxDQUFDLFdBQVc7Z0JBQ3ZCNEMsUUFBUVAsU0FBU08sTUFBTTtnQkFDdkJHLFlBQVlWLFNBQVNVLFVBQVU7Z0JBQy9CUixTQUFTUyxPQUFPQyxXQUFXLENBQUNaLFNBQVNFLE9BQU8sQ0FBQ04sT0FBTztZQUN0RDtZQUNBLE1BQU0sSUFBSXNCLE1BQU0sQ0FBQyxRQUFRLEVBQUVsQixTQUFTTyxNQUFNLENBQUMsQ0FBQyxFQUFFUCxTQUFTVSxVQUFVLENBQUMsQ0FBQztRQUNyRTtRQUVBLE1BQU0rQyxjQUFjekQsU0FBU0UsT0FBTyxDQUFDd0QsR0FBRyxDQUFDO1FBQ3pDLElBQUksQ0FBQ0QsYUFBYUUsV0FBVyxXQUFXO1lBQ3RDMUcsUUFBUVUsS0FBSyxDQUFDLFdBQVc4RjtZQUN6QixNQUFNLElBQUl2QyxNQUFNO1FBQ2xCO1FBRUEsTUFBTTBDLE9BQU8sTUFBTTVELFNBQVM0RCxJQUFJO1FBQ2hDM0csUUFBUUMsR0FBRyxDQUFDLFVBQVU7WUFDcEJnQyxNQUFNLENBQUMsRUFBRSxDQUFDMEUsS0FBSzFFLElBQUksR0FBRyxPQUFPLElBQUcsRUFBR0MsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ2pEYixNQUFNc0YsS0FBS3RGLElBQUk7UUFDakI7UUFFQSxPQUFPLE1BQU1FLGlCQUFpQm9GO0lBQ2hDLEVBQUUsT0FBT2pHLE9BQU87UUFDZFYsUUFBUVUsS0FBSyxDQUFDLGNBQWM7WUFDMUJBLE9BQU9BLGlCQUFpQnVELFFBQVF2RCxNQUFNbUUsT0FBTyxHQUFHQyxPQUFPcEU7WUFDdkR3RSxPQUFPeEUsaUJBQWlCdUQsUUFBUXZELE1BQU13RSxLQUFLLEdBQUdDO1lBQzlDdkQ7WUFDQW9DLFdBQVcsSUFBSTVCLE9BQU9DLFdBQVc7UUFDbkM7UUFDQSxNQUFNM0I7SUFDUjtBQUNGO0FBRU8sZUFBZWtHLEtBQUtwQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsWUFBWTtRQUNaLE1BQU1xQyxrQkFBa0I7WUFDdEI7WUFDQTtZQUNBO1lBQ0E7WUFDQTtTQUNEO1FBRUQsTUFBTUMsY0FBY0QsZ0JBQWdCRSxNQUFNLENBQUN0RSxDQUFBQSxNQUFPLENBQUNaLFFBQVFDLEdBQUcsQ0FBQ1csSUFBSTtRQUNuRSxJQUFJcUUsWUFBWUUsTUFBTSxHQUFHLEdBQUc7WUFDMUJoSCxRQUFRVSxLQUFLLENBQUMsV0FBV29HO1lBQ3pCLE9BQU8sSUFBSWpILGtGQUFZQSxDQUNyQm9ILEtBQUtDLFNBQVMsQ0FBQztnQkFDYnhHLE9BQU8sQ0FBQyxhQUFhLEVBQUVvRyxZQUFZSyxJQUFJLENBQUMsTUFBTSxDQUFDO2dCQUMvQ0MsV0FBVztZQUNiLElBQ0E7Z0JBQ0U5RCxRQUFRO2dCQUNSTCxTQUFTO29CQUFFLGdCQUFnQjtnQkFBbUI7WUFDaEQ7UUFFSjtRQUVBLFVBQVU7UUFDVixNQUFNeEIsV0FBVyxNQUFNK0MsUUFBUS9DLFFBQVEsR0FBRzRGLEtBQUssQ0FBQzNHLENBQUFBO1lBQzlDVixRQUFRVSxLQUFLLENBQUMsYUFBYUE7WUFDM0IsT0FBTztRQUNUO1FBRUEsSUFBSSxDQUFDZSxVQUFVO1lBQ2IsT0FBTyxJQUFJNUIsa0ZBQVlBLENBQ3JCb0gsS0FBS0MsU0FBUyxDQUFDO2dCQUNieEcsT0FBTztnQkFDUDBHLFdBQVc7WUFDYixJQUNBO2dCQUNFOUQsUUFBUTtnQkFDUkwsU0FBUztvQkFBRSxnQkFBZ0I7Z0JBQW1CO1lBQ2hEO1FBRUo7UUFFQSxNQUFNcUUsU0FBUzdGLFNBQVNnRixHQUFHLENBQUM7UUFDNUIsTUFBTWMsU0FBUzlGLFNBQVNnRixHQUFHLENBQUM7UUFFNUIsSUFBSSxDQUFDYSxVQUFVLENBQUNDLFFBQVE7WUFDdEIsT0FBTyxJQUFJMUgsa0ZBQVlBLENBQ3JCb0gsS0FBS0MsU0FBUyxDQUFDO2dCQUNieEcsT0FBTztnQkFDUDBHLFdBQVc7WUFDYixJQUNBO2dCQUNFOUQsUUFBUTtnQkFDUkwsU0FBUztvQkFBRSxnQkFBZ0I7Z0JBQW1CO1lBQ2hEO1FBRUo7UUFFQSxVQUFVO1FBQ1YsSUFBSTtZQUNGakQsUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTSxDQUFDdUgsV0FBV0MsVUFBVSxHQUFHLE1BQU03QixRQUFROEIsR0FBRyxDQUFDO2dCQUMvQ25HLGlCQUFpQitGO2dCQUNqQi9GLGlCQUFpQmdHO2FBQ2xCO1lBRUQsaUJBQWlCO1lBQ2pCdkgsUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTTBILGVBQWUsTUFBTTNFLE1BQU1uQixRQUFRQyxHQUFHLENBQUM4RixZQUFZLEVBQUc7Z0JBQzFENUYsUUFBUTtnQkFDUmlCLFNBQVM7b0JBQ1AsaUJBQWlCLENBQUMsT0FBTyxFQUFFcEIsUUFBUUMsR0FBRyxDQUFDK0YsYUFBYSxDQUFFQyxJQUFJLEdBQUcsQ0FBQztvQkFDOUQsZ0JBQWdCO29CQUNoQixVQUFVO2dCQUNaO2dCQUNBNUUsTUFBTStELEtBQUtDLFNBQVMsQ0FBQztvQkFDbkJhLGFBQWFsRyxRQUFRQyxHQUFHLENBQUNrRyxXQUFXLENBQUVGLElBQUk7b0JBQzFDRyxZQUFZO3dCQUFFQyxZQUFZVjt3QkFBV1csWUFBWVY7b0JBQVU7Z0JBQzdEO1lBQ0Y7WUFFQSxJQUFJLENBQUNFLGFBQWE5RCxFQUFFLEVBQUU7Z0JBQ3BCLE1BQU1DLFlBQVksTUFBTTZELGFBQWFuRSxJQUFJO2dCQUN6Q3hELFFBQVFVLEtBQUssQ0FBQyxrQkFBa0JvRDtnQkFDaEMsT0FBTyxJQUFJakUsa0ZBQVlBLENBQ3JCb0gsS0FBS0MsU0FBUyxDQUFDO29CQUNieEcsT0FBTztvQkFDUDBHLFdBQVc7b0JBQ1hnQixTQUFTdEU7Z0JBQ1gsSUFDQTtvQkFDRVIsUUFBUTtvQkFDUkwsU0FBUzt3QkFBRSxnQkFBZ0I7b0JBQW1CO2dCQUNoRDtZQUVKO1lBRUEsTUFBTW9GLGFBQWEsTUFBTVYsYUFBYXhELElBQUk7WUFFMUMsSUFBSWtFLFdBQVc5RSxJQUFJLEtBQUssR0FBRztnQkFDekIsT0FBTyxJQUFJMUQsa0ZBQVlBLENBQ3JCb0gsS0FBS0MsU0FBUyxDQUFDO29CQUNieEcsT0FBTzJILFdBQVdDLEdBQUcsSUFBSTtvQkFDekJsQixXQUFXO29CQUNYZ0IsU0FBU0M7Z0JBQ1gsSUFDQTtvQkFDRS9FLFFBQVE7b0JBQ1JMLFNBQVM7d0JBQUUsZ0JBQWdCO29CQUFtQjtnQkFDaEQ7WUFFSjtZQUVBLGFBQWE7WUFDYixNQUFNc0YsYUFBYSxPQUFPRixXQUFXRyxJQUFJLEtBQUssV0FDMUN2QixLQUFLd0IsS0FBSyxDQUFDSixXQUFXRyxJQUFJLElBQzFCSCxXQUFXRyxJQUFJO1lBRW5CLElBQUksQ0FBQ0QsWUFBWUcsUUFBUTtnQkFDdkIsT0FBTyxJQUFJN0ksa0ZBQVlBLENBQ3JCb0gsS0FBS0MsU0FBUyxDQUFDO29CQUNieEcsT0FBTztvQkFDUDBHLFdBQVc7b0JBQ1hnQixTQUFTQztnQkFDWCxJQUNBO29CQUNFL0UsUUFBUTtvQkFDUkwsU0FBUzt3QkFBRSxnQkFBZ0I7b0JBQW1CO2dCQUNoRDtZQUVKO1lBRUEsZUFBZTtZQUNmLE1BQU0wRixnQkFBZ0IsTUFBTTVDLHVCQUF1QndDLFdBQVdHLE1BQU07WUFFcEUsT0FBTyxJQUFJN0ksa0ZBQVlBLENBQ3JCb0gsS0FBS0MsU0FBUyxDQUFDO2dCQUNiMEIsV0FBV0Q7Z0JBQ1hFLGFBQWFOLFdBQVdHLE1BQU07Z0JBQzlCSSxhQUFhVDtZQUNmLElBQ0E7Z0JBQ0UvRSxRQUFRO2dCQUNSTCxTQUFTO29CQUFFLGdCQUFnQjtnQkFBbUI7WUFDaEQ7UUFHSixFQUFFLE9BQU92QyxPQUFPO1lBQ2RWLFFBQVFVLEtBQUssQ0FBQyxXQUFXO2dCQUN2QkEsT0FBT0EsaUJBQWlCdUQsUUFBUXZELE1BQU1tRSxPQUFPLEdBQUdDLE9BQU9wRTtnQkFDdkR3RSxPQUFPeEUsaUJBQWlCdUQsUUFBUXZELE1BQU13RSxLQUFLLEdBQUdDO2dCQUM5Q25CLFdBQVcsSUFBSTVCLE9BQU9DLFdBQVc7Z0JBQ2pDK0YsU0FBUzFILGlCQUFpQnVELFFBQVF2RCxNQUFNcUksS0FBSyxHQUFHNUQ7WUFDbEQ7WUFFQSxPQUFPLElBQUl0RixrRkFBWUEsQ0FDckJvSCxLQUFLQyxTQUFTLENBQUM7Z0JBQ2J4RyxPQUFPQSxpQkFBaUJ1RCxRQUFRdkQsTUFBTW1FLE9BQU8sR0FBRztnQkFDaER1QyxXQUFXO2dCQUNYZ0IsU0FBUzFILGlCQUFpQnVELFFBQVF2RCxNQUFNd0UsS0FBSyxHQUFHQztZQUNsRCxJQUNBO2dCQUNFN0IsUUFBUTtnQkFDUkwsU0FBUztvQkFBRSxnQkFBZ0I7Z0JBQW1CO1lBQ2hEO1FBRUo7SUFFRixFQUFFLE9BQU92QyxPQUFPO1FBQ2QsVUFBVTtRQUNWVixRQUFRVSxLQUFLLENBQUMsYUFBYUE7UUFDM0IsT0FBTyxJQUFJYixrRkFBWUEsQ0FDckJvSCxLQUFLQyxTQUFTLENBQUM7WUFDYnhHLE9BQU87WUFDUDBHLFdBQVc7WUFDWGdCLFNBQVMxSCxpQkFBaUJ1RCxRQUFRdkQsTUFBTXdFLEtBQUssR0FBR0M7UUFDbEQsSUFDQTtZQUNFN0IsUUFBUTtZQUNSTCxTQUFTO2dCQUFFLGdCQUFnQjtZQUFtQjtRQUNoRDtJQUVKO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mYWNlLXN3YXAtYXBwLy4vYXBwL2FwaS9tZXJnZS9yb3V0ZS50cz82NTc4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHNoYXJwIGZyb20gJ3NoYXJwJ1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gY29tcHJlc3NJbWFnZShmaWxlOiBGaWxlKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCflvIDlp4vljovnvKnlm77niYcuLi4nKVxyXG4gICAgY29uc3QgYnVmZmVyID0gYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpXHJcbiAgICBjb25zdCBmaWxlQnVmZmVyID0gQnVmZmVyLmZyb20oYnVmZmVyKVxyXG5cclxuICAgIGxldCBzaGFycEluc3RhbmNlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g5bCd6K+V5Yqo5oCB5a+85YWlIHNoYXJwXHJcbiAgICAgIGNvbnN0IHNoYXJwTW9kdWxlID0gYXdhaXQgaW1wb3J0KCdzaGFycCcpO1xyXG4gICAgICBzaGFycEluc3RhbmNlID0gc2hhcnBNb2R1bGUuZGVmYXVsdDtcclxuICAgICAgY29uc29sZS5sb2coJ1NoYXJwIOaooeWdl+WKoOi9veaIkOWKnycpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignU2hhcnAg5qih5Z2X5Yqg6L295aSx6LSlOicsIGVycm9yKTtcclxuICAgICAgLy8g5aaC5p6c5peg5rOV5Yqg6L29IHNoYXJw77yM6L+U5Zue5Y6f5Zu+XHJcbiAgICAgIHJldHVybiBmaWxlO1xyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCflvIDlp4vlpITnkIblm77niYcnKTtcclxuICAgICAgY29uc3QgY29tcHJlc3NlZEJ1ZmZlciA9IGF3YWl0IHNoYXJwSW5zdGFuY2UoZmlsZUJ1ZmZlcilcclxuICAgICAgICAucmVzaXplKDE5MjAsIDE5MjAsIHtcclxuICAgICAgICAgIGZpdDogJ2luc2lkZScsXHJcbiAgICAgICAgICB3aXRob3V0RW5sYXJnZW1lbnQ6IHRydWVcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5qcGVnKHtcclxuICAgICAgICAgIHF1YWxpdHk6IDgwLFxyXG4gICAgICAgICAgcHJvZ3Jlc3NpdmU6IHRydWVcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50b0J1ZmZlcigpO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coJ+WbvueJh+WOi+e8qeWujOaIkCcpO1xyXG4gICAgICByZXR1cm4gbmV3IEZpbGUoW2NvbXByZXNzZWRCdWZmZXJdLCBmaWxlLm5hbWUsIHsgdHlwZTogJ2ltYWdlL2pwZWcnIH0pO1xyXG4gICAgfSBjYXRjaCAocHJvY2Vzc0Vycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WbvueJh+WkhOeQhuWksei0pTonLCBwcm9jZXNzRXJyb3IpO1xyXG4gICAgICByZXR1cm4gZmlsZTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign5Zu+54mH5Y6L57yp6L+H56iL5Ye66ZSZOicsIGVycm9yKTtcclxuICAgIC8vIOWmguaenOWOi+e8qeWksei0pe+8jOi/lOWbnuWOn+WbvlxyXG4gICAgcmV0dXJuIGZpbGU7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiB1cGxvYWRUb0ltYWdlSHViKGZpbGU6IEZpbGUgfCBCbG9iLCByZXRyeUNvdW50ID0gMCk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKClcclxuICAgIGZvcm1EYXRhLmFwcGVuZCgnc291cmNlJywgZmlsZSlcclxuXHJcbiAgICBjb25zb2xlLmxvZygn5YeG5aSH5LiK5Lyg5Zu+54mH5Yiw5Zu+5bqKOicsIHtcclxuICAgICAgdXJsOiBwcm9jZXNzLmVudi5JTUFHRUhVQl9BUElfVVJMLFxyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgZmlsZToge1xyXG4gICAgICAgIHR5cGU6IGZpbGUudHlwZSxcclxuICAgICAgICBzaXplOiBgJHsoZmlsZS5zaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMil9TUJgLFxyXG4gICAgICAgIGxhc3RNb2RpZmllZDogZmlsZSBpbnN0YW5jZW9mIEZpbGUgPyBuZXcgRGF0ZShmaWxlLmxhc3RNb2RpZmllZCkudG9JU09TdHJpbmcoKSA6ICdOL0EnLFxyXG4gICAgICAgIG5hbWU6IGZpbGUgaW5zdGFuY2VvZiBGaWxlID8gZmlsZS5uYW1lIDogJ2Jsb2InXHJcbiAgICAgIH0sXHJcbiAgICAgIHJldHJ5Q291bnRcclxuICAgIH0pXHJcblxyXG4gICAgY29uc3QgcmVxdWVzdEhlYWRlcnMgPSB7XHJcbiAgICAgICdYLUFQSS1LZXknOiAnKioqJyArIHByb2Nlc3MuZW52LklNQUdFSFVCX0FQSV9LRVkhLnNsaWNlKC02KVxyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2coJ+ivt+axguWktDonLCByZXF1ZXN0SGVhZGVycylcclxuXHJcbiAgICBjb25zb2xlLmxvZygnRm9ybURhdGEg5YaF5a65OicpXHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBmb3JtRGF0YS5lbnRyaWVzKCkpIHtcclxuICAgICAgY29uc29sZS5sb2coJy0gJywga2V5LCAnOicsIHtcclxuICAgICAgICB0eXBlOiB2YWx1ZSBpbnN0YW5jZW9mIEJsb2IgPyB2YWx1ZS50eXBlIDogdHlwZW9mIHZhbHVlLFxyXG4gICAgICAgIHNpemU6IHZhbHVlIGluc3RhbmNlb2YgQmxvYiA/IGAkeyh2YWx1ZS5zaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMil9TUJgIDogJ04vQScsXHJcbiAgICAgICAgbmFtZTogdmFsdWUgaW5zdGFuY2VvZiBGaWxlID8gdmFsdWUubmFtZSA6ICdibG9iJ1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KClcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2gocHJvY2Vzcy5lbnYuSU1BR0VIVUJfQVBJX1VSTCEsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnWC1BUEktS2V5JzogcHJvY2Vzcy5lbnYuSU1BR0VIVUJfQVBJX0tFWSEsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IGZvcm1EYXRhXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpXHJcblxyXG4gICAgY29uc29sZS5sb2coJ+WbvuW6iuWTjeW6lOivpuaDhTonLCB7XHJcbiAgICAgIHRpbWluZzoge1xyXG4gICAgICAgIHN0YXJ0VGltZTogbmV3IERhdGUoc3RhcnRUaW1lKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGVuZFRpbWU6IG5ldyBEYXRlKGVuZFRpbWUpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgZHVyYXRpb246IGAke2VuZFRpbWUgLSBzdGFydFRpbWV9bXNgXHJcbiAgICAgIH0sXHJcbiAgICAgIHN0YXR1czoge1xyXG4gICAgICAgIGNvZGU6IHJlc3BvbnNlLnN0YXR1cyxcclxuICAgICAgICB0ZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0XHJcbiAgICAgIH0sXHJcbiAgICAgIGhlYWRlcnM6IE9iamVjdC5mcm9tRW50cmllcyhyZXNwb25zZS5oZWFkZXJzLmVudHJpZXMoKSksXHJcbiAgICAgIHR5cGU6IHJlc3BvbnNlLnR5cGUsXHJcbiAgICAgIHVybDogcmVzcG9uc2UudXJsLFxyXG4gICAgICByZWRpcmVjdGVkOiByZXNwb25zZS5yZWRpcmVjdGVkXHJcbiAgICB9KVxyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WbvuW6iuS4iuS8oOWksei0pTonLCB7XHJcbiAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXHJcbiAgICAgICAgc3RhdHVzVGV4dDogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcclxuICAgICAgICByZXNwb25zZUJvZHk6IGVycm9yVGV4dCxcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICB9KVxyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+WbvueJh+S4iuS8oOWksei0pScpXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXHJcbiAgICBjb25zb2xlLmxvZygn5Zu+5bqK5LiK5Lyg5oiQ5YqfOicsIHtcclxuICAgICAgdGltaW5nOiB7XHJcbiAgICAgICAgdG90YWw6IGAke2VuZFRpbWUgLSBzdGFydFRpbWV9bXNgLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0sXHJcbiAgICAgIHJlc3BvbnNlOiB7XHJcbiAgICAgICAgc3RhdHVzX2NvZGU6IHJlc3VsdC5zdGF0dXNfY29kZSxcclxuICAgICAgICBzdGF0dXNfdHh0OiByZXN1bHQuc3RhdHVzX3R4dCxcclxuICAgICAgICBpbWFnZTogcmVzdWx0LmltYWdlXHJcbiAgICAgIH0sXHJcbiAgICAgIHJlcXVlc3Q6IHtcclxuICAgICAgICBvcmlnaW5hbEZpbGU6IHtcclxuICAgICAgICAgIHR5cGU6IGZpbGUudHlwZSxcclxuICAgICAgICAgIHNpemU6IGAkeyhmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCkudG9GaXhlZCgyKX1NQmAsXHJcbiAgICAgICAgICBuYW1lOiBmaWxlIGluc3RhbmNlb2YgRmlsZSA/IGZpbGUubmFtZSA6ICdibG9iJ1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAocmVzdWx0LnN0YXR1c19jb2RlICE9PSAyMDApIHtcclxuICAgICAgY29uc29sZS5lcnJvcign5Zu+5bqK6L+U5Zue6ZSZ6K+vOicsIHtcclxuICAgICAgICByZXN1bHQsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgcmVxdWVzdERldGFpbHM6IHtcclxuICAgICAgICAgIGZpbGVUeXBlOiBmaWxlLnR5cGUsXHJcbiAgICAgICAgICBmaWxlU2l6ZTogYCR7KGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDIpfU1CYFxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3VsdC5zdGF0dXNfdHh0IHx8ICflm77niYfkuIrkvKDlpLHotKUnKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHQuaW1hZ2UudXJsXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGlmIChyZXRyeUNvdW50IDwgMikge1xyXG4gICAgICBjb25zb2xlLmxvZyhg5LiK5Lyg5aSx6LSl77yM5YeG5aSH6YeN6K+VICjnrKwke3JldHJ5Q291bnQgKyAxfeasoSk6YCwge1xyXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvciksXHJcbiAgICAgICAgbmV4dEFjdGlvbjogJ+WwneivleWOi+e8qeWQjumHjeaWsOS4iuS8oCcsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgZmlsZUluZm86IHtcclxuICAgICAgICAgIHR5cGU6IGZpbGUudHlwZSxcclxuICAgICAgICAgIHNpemU6IGAkeyhmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCkudG9GaXhlZCgyKX1NQmAsXHJcbiAgICAgICAgICBuYW1lOiBmaWxlIGluc3RhbmNlb2YgRmlsZSA/IGZpbGUubmFtZSA6ICdibG9iJ1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgY29uc3QgY29tcHJlc3NlZEZpbGUgPSBhd2FpdCBjb21wcmVzc0ltYWdlKGZpbGUgaW5zdGFuY2VvZiBGaWxlID8gZmlsZSA6IG5ldyBGaWxlKFtmaWxlXSwgJ2ltYWdlLmpwZycpKVxyXG4gICAgICByZXR1cm4gdXBsb2FkVG9JbWFnZUh1Yihjb21wcmVzc2VkRmlsZSwgcmV0cnlDb3VudCArIDEpXHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmVycm9yKCflm77niYfkuIrkvKDmnIDnu4jlpLHotKU6Jywge1xyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpLFxyXG4gICAgICBzdGFjazogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogdW5kZWZpbmVkLFxyXG4gICAgICByZXRyeUNvdW50LFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgZmlsZURldGFpbHM6IHtcclxuICAgICAgICB0eXBlOiBmaWxlLnR5cGUsXHJcbiAgICAgICAgc2l6ZTogYCR7KGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDIpfU1CYCxcclxuICAgICAgICBuYW1lOiBmaWxlIGluc3RhbmNlb2YgRmlsZSA/IGZpbGUubmFtZSA6ICdibG9iJ1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgdGhyb3cgZXJyb3JcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGZldGNoV2l0aFJldHJ5KFxyXG4gIHVybDogc3RyaW5nLFxyXG4gIG9wdGlvbnM6IFJlcXVlc3RJbml0LFxyXG4gIHJldHJpZXMgPSAzLFxyXG4gIGRlbGF5ID0gMTAwMFxyXG4pOiBQcm9taXNlPFJlc3BvbnNlPiB7XHJcbiAgbGV0IGxhc3RFcnJvcjogRXJyb3IgPSBuZXcgRXJyb3IoJ1Vua25vd24gZXJyb3InKVxyXG4gIFxyXG4gIGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDwgcmV0cmllczsgYXR0ZW1wdCsrKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgb3B0aW9ucylcclxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSByZXR1cm4gcmVzcG9uc2VcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKVxyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9IC0gJHtlcnJvclRleHR9YClcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGxhc3RFcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKVxyXG4gICAgICBjb25zb2xlLmxvZyhg6K+35rGC5aSx6LSl77yM56ysICR7YXR0ZW1wdCArIDF9IOasoemHjeivlTpgLCB7XHJcbiAgICAgICAgZXJyb3I6IGxhc3RFcnJvci5tZXNzYWdlLFxyXG4gICAgICAgIG5leHRSZXRyeUluOiBhdHRlbXB0IDwgcmV0cmllcyAtIDEgPyBgJHtkZWxheX1tc2AgOiAnbm8gbW9yZSByZXRyaWVzJyxcclxuICAgICAgICB1cmwsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSlcclxuICAgICAgXHJcbiAgICAgIGlmIChhdHRlbXB0IDwgcmV0cmllcyAtIDEpIHtcclxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKVxyXG4gICAgICAgIGNvbnRpbnVlXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgdGhyb3cgbGFzdEVycm9yXHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGRvd25sb2FkQW5kVXBsb2FkSW1hZ2UodXJsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZygn5byA5aeL5LiL6L295Zu+54mHOicsIHVybClcclxuICAgIFxyXG4gICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKVxyXG4gICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLCAzMDAwMClcclxuICAgIFxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaFdpdGhSZXRyeShcclxuICAgICAgdXJsLFxyXG4gICAgICB7XHJcbiAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTEuMC40NDcyLjEyNCBTYWZhcmkvNTM3LjM2JyxcclxuICAgICAgICAgICdBY2NlcHQnOiAnaW1hZ2UvKiwgKi8qJyxcclxuICAgICAgICAgICdBY2NlcHQtRW5jb2RpbmcnOiAnZ3ppcCwgZGVmbGF0ZSwgYnInLFxyXG4gICAgICAgICAgJ0Nvbm5lY3Rpb24nOiAna2VlcC1hbGl2ZSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIGtlZXBhbGl2ZTogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICAzLCAgLy8g6YeN6K+V5qyh5pWwXHJcbiAgICAgIDEwMDAgLy8g6YeN6K+V5bu26L+fXHJcbiAgICApLmZpbmFsbHkoKCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVvdXQpKVxyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgY29uc29sZS5lcnJvcign5Zu+54mH5LiL6L295aSx6LSlOicsIHtcclxuICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcclxuICAgICAgICBzdGF0dXNUZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0LFxyXG4gICAgICAgIGhlYWRlcnM6IE9iamVjdC5mcm9tRW50cmllcyhyZXNwb25zZS5oZWFkZXJzLmVudHJpZXMoKSlcclxuICAgICAgfSlcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGDlm77niYfkuIvovb3lpLHotKU6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YClcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgY29udGVudFR5cGUgPSByZXNwb25zZS5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJylcclxuICAgIGlmICghY29udGVudFR5cGU/LnN0YXJ0c1dpdGgoJ2ltYWdlLycpKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WTjeW6lOS4jeaYr+WbvueJhzonLCBjb250ZW50VHlwZSlcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCfkuIvovb3nmoTlhoXlrrnkuI3mmK/lm77niYcnKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXNwb25zZS5ibG9iKClcclxuICAgIGNvbnNvbGUubG9nKCflm77niYfkuIvovb3lrozmiJAnLCB7XHJcbiAgICAgIHNpemU6IGAkeyhibG9iLnNpemUgLyAxMDI0IC8gMTAyNCkudG9GaXhlZCgyKX1NQmAsXHJcbiAgICAgIHR5cGU6IGJsb2IudHlwZVxyXG4gICAgfSlcclxuICAgIFxyXG4gICAgcmV0dXJuIGF3YWl0IHVwbG9hZFRvSW1hZ2VIdWIoYmxvYilcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign5LiL6L295bm25LiK5Lyg5Zu+54mH5aSx6LSlOicsIHtcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcclxuICAgICAgc3RhY2s6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6IHVuZGVmaW5lZCxcclxuICAgICAgdXJsLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSlcclxuICAgIHRocm93IGVycm9yXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyAxLiDnjq/looPlj5jph4/pqozor4FcclxuICAgIGNvbnN0IHJlcXVpcmVkRW52VmFycyA9IFtcclxuICAgICAgJ1dPUktGTE9XX0lEJyxcclxuICAgICAgJ0NPWkVfQVBJX1VSTCcsXHJcbiAgICAgICdBVVRIT1JJWkFUSU9OJyxcclxuICAgICAgJ0lNQUdFSFVCX0FQSV9VUkwnLFxyXG4gICAgICAnSU1BR0VIVUJfQVBJX0tFWSdcclxuICAgIF1cclxuICAgIFxyXG4gICAgY29uc3QgbWlzc2luZ1ZhcnMgPSByZXF1aXJlZEVudlZhcnMuZmlsdGVyKGtleSA9PiAhcHJvY2Vzcy5lbnZba2V5XSlcclxuICAgIGlmIChtaXNzaW5nVmFycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+e8uuWwkeeOr+Wig+WPmOmHjzonLCBtaXNzaW5nVmFycylcclxuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoXHJcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgZXJyb3I6IGDphY3nva7plJnor686IOe8uuWwkeeOr+Wig+WPmOmHjyAke21pc3NpbmdWYXJzLmpvaW4oJywgJyl9YCxcclxuICAgICAgICAgIGVycm9yVHlwZTogJ0NvbmZpZ0Vycm9yJ1xyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHN0YXR1czogNTAwLFxyXG4gICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cclxuICAgICAgICB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyAyLiDor7fmsYLpqozor4FcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gYXdhaXQgcmVxdWVzdC5mb3JtRGF0YSgpLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcign6Kej5p6Q6KGo5Y2V5pWw5o2u5aSx6LSlOicsIGVycm9yKVxyXG4gICAgICByZXR1cm4gbnVsbFxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoIWZvcm1EYXRhKSB7XHJcbiAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIGVycm9yOiAn5peg5pWI55qE6K+35rGC5pWw5o2uJyxcclxuICAgICAgICAgIGVycm9yVHlwZTogJ1ZhbGlkYXRpb25FcnJvcidcclxuICAgICAgICB9KSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdGF0dXM6IDQwMCxcclxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgICAgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaW1hZ2UxID0gZm9ybURhdGEuZ2V0KCdpbWFnZTEnKSBhcyBGaWxlXHJcbiAgICBjb25zdCBpbWFnZTIgPSBmb3JtRGF0YS5nZXQoJ2ltYWdlMicpIGFzIEZpbGVcclxuXHJcbiAgICBpZiAoIWltYWdlMSB8fCAhaW1hZ2UyKSB7XHJcbiAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIGVycm9yOiAn6K+35o+Q5L6b5Lik5byg5Zu+54mHJyxcclxuICAgICAgICAgIGVycm9yVHlwZTogJ1ZhbGlkYXRpb25FcnJvcidcclxuICAgICAgICB9KSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdGF0dXM6IDQwMCxcclxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgICAgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gMy4g5Zu+54mH5aSE55CGXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZygn5byA5aeL5LiK5Lyg5Y6f5aeL5Zu+54mHLi4uJylcclxuICAgICAgY29uc3QgW2ltYWdlMVVybCwgaW1hZ2UyVXJsXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgICB1cGxvYWRUb0ltYWdlSHViKGltYWdlMSksXHJcbiAgICAgICAgdXBsb2FkVG9JbWFnZUh1YihpbWFnZTIpXHJcbiAgICAgIF0pXHJcblxyXG4gICAgICAvLyA0LiDosIPnlKggQ296ZSBBUElcclxuICAgICAgY29uc29sZS5sb2coJ+iwg+eUqCBDb3plIEFQSS4uLicpXHJcbiAgICAgIGNvbnN0IGNvemVSZXNwb25zZSA9IGF3YWl0IGZldGNoKHByb2Nlc3MuZW52LkNPWkVfQVBJX1VSTCEsIHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtwcm9jZXNzLmVudi5BVVRIT1JJWkFUSU9OIS50cmltKCl9YCxcclxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICB3b3JrZmxvd19pZDogcHJvY2Vzcy5lbnYuV09SS0ZMT1dfSUQhLnRyaW0oKSxcclxuICAgICAgICAgIHBhcmFtZXRlcnM6IHsgZmFjZV9pbWFnZTogaW1hZ2UxVXJsLCBiYXNlX2ltYWdlOiBpbWFnZTJVcmwgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICBpZiAoIWNvemVSZXNwb25zZS5vaykge1xyXG4gICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IGNvemVSZXNwb25zZS50ZXh0KClcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdDb3plIEFQSSDplJnor6/lk43lupQ6JywgZXJyb3JUZXh0KVxyXG4gICAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBlcnJvcjogJ0FJIOWkhOeQhuWksei0pScsXHJcbiAgICAgICAgICAgIGVycm9yVHlwZTogJ0NvemVBUElFcnJvcicsXHJcbiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yVGV4dFxyXG4gICAgICAgICAgfSksXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHN0YXR1czogNTAyLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgY296ZVJlc3VsdCA9IGF3YWl0IGNvemVSZXNwb25zZS5qc29uKClcclxuICAgICAgXHJcbiAgICAgIGlmIChjb3plUmVzdWx0LmNvZGUgIT09IDApIHtcclxuICAgICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShcclxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgZXJyb3I6IGNvemVSZXN1bHQubXNnIHx8ICdBSSDlpITnkIblpLHotKUnLFxyXG4gICAgICAgICAgICBlcnJvclR5cGU6ICdDb3plQVBJRXJyb3InLFxyXG4gICAgICAgICAgICBkZXRhaWxzOiBjb3plUmVzdWx0XHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgc3RhdHVzOiA1MDIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyA1LiDlpITnkIbov5Tlm57nmoTlm77niYdcclxuICAgICAgY29uc3Qgb3V0cHV0RGF0YSA9IHR5cGVvZiBjb3plUmVzdWx0LmRhdGEgPT09ICdzdHJpbmcnIFxyXG4gICAgICAgID8gSlNPTi5wYXJzZShjb3plUmVzdWx0LmRhdGEpIFxyXG4gICAgICAgIDogY296ZVJlc3VsdC5kYXRhXHJcblxyXG4gICAgICBpZiAoIW91dHB1dERhdGE/Lm91dHB1dCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBlcnJvcjogJ+WkhOeQhue7k+aenOaXoOaViCcsXHJcbiAgICAgICAgICAgIGVycm9yVHlwZTogJ1Byb2Nlc3NFcnJvcicsXHJcbiAgICAgICAgICAgIGRldGFpbHM6IGNvemVSZXN1bHRcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBzdGF0dXM6IDUwMCxcclxuICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIDYuIOS4iuS8oOe7k+aenOWbvueJh+WIsOWbvuW6ilxyXG4gICAgICBjb25zdCBmaW5hbEltYWdlVXJsID0gYXdhaXQgZG93bmxvYWRBbmRVcGxvYWRJbWFnZShvdXRwdXREYXRhLm91dHB1dClcclxuXHJcbiAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIHJlc3VsdFVybDogZmluYWxJbWFnZVVybCxcclxuICAgICAgICAgIG9yaWdpbmFsVXJsOiBvdXRwdXREYXRhLm91dHB1dCxcclxuICAgICAgICAgIHJhd1Jlc3BvbnNlOiBjb3plUmVzdWx0XHJcbiAgICAgICAgfSksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc3RhdHVzOiAyMDAsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxyXG4gICAgICAgIH1cclxuICAgICAgKVxyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WkhOeQhui/h+eoi+mUmeivrzonLCB7XHJcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcclxuICAgICAgICBzdGFjazogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogdW5kZWZpbmVkLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5jYXVzZSA6IHVuZGVmaW5lZFxyXG4gICAgICB9KVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoXHJcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+WkhOeQhuWksei0pScsXHJcbiAgICAgICAgICBlcnJvclR5cGU6ICdQcm9jZXNzRXJyb3InLFxyXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogdW5kZWZpbmVkXHJcbiAgICAgICAgfSksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc3RhdHVzOiA1MDAsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxyXG4gICAgICAgIH1cclxuICAgICAgKVxyXG4gICAgfVxyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgLy8g5pyA5aSW5bGC6ZSZ6K+v5aSE55CGXHJcbiAgICBjb25zb2xlLmVycm9yKCdBUEkg6Ie05ZG96ZSZ6K+vOicsIGVycm9yKVxyXG4gICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoXHJcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBlcnJvcjogJ+acjeWKoeWZqOWGhemDqOmUmeivrycsXHJcbiAgICAgICAgZXJyb3JUeXBlOiAnU2VydmVyRXJyb3InLFxyXG4gICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6IHVuZGVmaW5lZFxyXG4gICAgICB9KSxcclxuICAgICAge1xyXG4gICAgICAgIHN0YXR1czogNTAwLFxyXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgIH1cclxuICAgIClcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNvbXByZXNzSW1hZ2UiLCJmaWxlIiwiY29uc29sZSIsImxvZyIsImJ1ZmZlciIsImFycmF5QnVmZmVyIiwiZmlsZUJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJzaGFycEluc3RhbmNlIiwic2hhcnBNb2R1bGUiLCJkZWZhdWx0IiwiZXJyb3IiLCJjb21wcmVzc2VkQnVmZmVyIiwicmVzaXplIiwiZml0Iiwid2l0aG91dEVubGFyZ2VtZW50IiwianBlZyIsInF1YWxpdHkiLCJwcm9ncmVzc2l2ZSIsInRvQnVmZmVyIiwiRmlsZSIsIm5hbWUiLCJ0eXBlIiwicHJvY2Vzc0Vycm9yIiwidXBsb2FkVG9JbWFnZUh1YiIsInJldHJ5Q291bnQiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwidXJsIiwicHJvY2VzcyIsImVudiIsIklNQUdFSFVCX0FQSV9VUkwiLCJtZXRob2QiLCJzaXplIiwidG9GaXhlZCIsImxhc3RNb2RpZmllZCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInJlcXVlc3RIZWFkZXJzIiwiSU1BR0VIVUJfQVBJX0tFWSIsInNsaWNlIiwia2V5IiwidmFsdWUiLCJlbnRyaWVzIiwiQmxvYiIsInN0YXJ0VGltZSIsIm5vdyIsInJlc3BvbnNlIiwiZmV0Y2giLCJoZWFkZXJzIiwiYm9keSIsImVuZFRpbWUiLCJ0aW1pbmciLCJkdXJhdGlvbiIsInN0YXR1cyIsImNvZGUiLCJ0ZXh0Iiwic3RhdHVzVGV4dCIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwicmVkaXJlY3RlZCIsIm9rIiwiZXJyb3JUZXh0IiwicmVzcG9uc2VCb2R5IiwidGltZXN0YW1wIiwiRXJyb3IiLCJyZXN1bHQiLCJqc29uIiwidG90YWwiLCJzdGF0dXNfY29kZSIsInN0YXR1c190eHQiLCJpbWFnZSIsInJlcXVlc3QiLCJvcmlnaW5hbEZpbGUiLCJyZXF1ZXN0RGV0YWlscyIsImZpbGVUeXBlIiwiZmlsZVNpemUiLCJtZXNzYWdlIiwiU3RyaW5nIiwibmV4dEFjdGlvbiIsImZpbGVJbmZvIiwiY29tcHJlc3NlZEZpbGUiLCJzdGFjayIsInVuZGVmaW5lZCIsImZpbGVEZXRhaWxzIiwiZmV0Y2hXaXRoUmV0cnkiLCJvcHRpb25zIiwicmV0cmllcyIsImRlbGF5IiwibGFzdEVycm9yIiwiYXR0ZW1wdCIsIm5leHRSZXRyeUluIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiZG93bmxvYWRBbmRVcGxvYWRJbWFnZSIsImNvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJ0aW1lb3V0IiwiYWJvcnQiLCJzaWduYWwiLCJrZWVwYWxpdmUiLCJmaW5hbGx5IiwiY2xlYXJUaW1lb3V0IiwiY29udGVudFR5cGUiLCJnZXQiLCJzdGFydHNXaXRoIiwiYmxvYiIsIlBPU1QiLCJyZXF1aXJlZEVudlZhcnMiLCJtaXNzaW5nVmFycyIsImZpbHRlciIsImxlbmd0aCIsIkpTT04iLCJzdHJpbmdpZnkiLCJqb2luIiwiZXJyb3JUeXBlIiwiY2F0Y2giLCJpbWFnZTEiLCJpbWFnZTIiLCJpbWFnZTFVcmwiLCJpbWFnZTJVcmwiLCJhbGwiLCJjb3plUmVzcG9uc2UiLCJDT1pFX0FQSV9VUkwiLCJBVVRIT1JJWkFUSU9OIiwidHJpbSIsIndvcmtmbG93X2lkIiwiV09SS0ZMT1dfSUQiLCJwYXJhbWV0ZXJzIiwiZmFjZV9pbWFnZSIsImJhc2VfaW1hZ2UiLCJkZXRhaWxzIiwiY296ZVJlc3VsdCIsIm1zZyIsIm91dHB1dERhdGEiLCJkYXRhIiwicGFyc2UiLCJvdXRwdXQiLCJmaW5hbEltYWdlVXJsIiwicmVzdWx0VXJsIiwib3JpZ2luYWxVcmwiLCJyYXdSZXNwb25zZSIsImNhdXNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/merge/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmerge%2Froute&page=%2Fapi%2Fmerge%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmerge%2Froute.ts&appDir=D%3A%5CCursor%5Cface2exchange%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCursor%5Cface2exchange&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();