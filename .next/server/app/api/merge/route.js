"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/merge/route";
exports.ids = ["app/api/merge/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "sharp":
/*!************************!*\
  !*** external "sharp" ***!
  \************************/
/***/ ((module) => {

module.exports = require("sharp");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmerge%2Froute&page=%2Fapi%2Fmerge%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmerge%2Froute.ts&appDir=D%3A%5CCursor%5Cface2exchange%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCursor%5Cface2exchange&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmerge%2Froute&page=%2Fapi%2Fmerge%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmerge%2Froute.ts&appDir=D%3A%5CCursor%5Cface2exchange%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCursor%5Cface2exchange&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_node_polyfill_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/node-polyfill-headers */ \"(rsc)/./node_modules/next/dist/server/node-polyfill-headers.js\");\n/* harmony import */ var next_dist_server_node_polyfill_headers__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_node_polyfill_headers__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var D_Cursor_face2exchange_app_api_merge_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/merge/route.ts */ \"(rsc)/./app/api/merge/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_1__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_2__.RouteKind.APP_ROUTE,\n        page: \"/api/merge/route\",\n        pathname: \"/api/merge\",\n        filename: \"route\",\n        bundlePath: \"app/api/merge/route\"\n    },\n    resolvedPagePath: \"D:\\\\Cursor\\\\face2exchange\\\\app\\\\api\\\\merge\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Cursor_face2exchange_app_api_merge_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/merge/route\";\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtZXJnZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGbWVyZ2UlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZtZXJnZSUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQ3Vyc29yJTVDZmFjZTJleGNoYW5nZSU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RCUzQSU1Q0N1cnNvciU1Q2ZhY2UyZXhjaGFuZ2UmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBZ0Q7QUFDc0Q7QUFDdkM7QUFDa0I7QUFDakY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDaUo7O0FBRWpKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZmFjZS1zd2FwLWFwcC8/NjYwYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXCJuZXh0L2Rpc3Qvc2VydmVyL25vZGUtcG9seWZpbGwtaGVhZGVyc1wiO1xuaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcQ3Vyc29yXFxcXGZhY2UyZXhjaGFuZ2VcXFxcYXBwXFxcXGFwaVxcXFxtZXJnZVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvbWVyZ2Uvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9tZXJnZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbWVyZ2Uvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxDdXJzb3JcXFxcZmFjZTJleGNoYW5nZVxcXFxhcHBcXFxcYXBpXFxcXG1lcmdlXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL21lcmdlL3JvdXRlXCI7XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmerge%2Froute&page=%2Fapi%2Fmerge%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmerge%2Froute.ts&appDir=D%3A%5CCursor%5Cface2exchange%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCursor%5Cface2exchange&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/merge/route.ts":
/*!********************************!*\
  !*** ./app/api/merge/route.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sharp */ \"sharp\");\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sharp__WEBPACK_IMPORTED_MODULE_1__);\n\n\nasync function compressImage(file) {\n    try {\n        const buffer = await file.arrayBuffer();\n        const fileBuffer = Buffer.from(buffer);\n        const randomQuality = 0.59 + Math.random() * (0.99 - 0.59);\n        const finalQuality = Math.floor(80 * randomQuality);\n        console.log(\"压缩质量系数:\", randomQuality.toFixed(6));\n        console.log(\"最终压缩质量:\", finalQuality);\n        const compressedBuffer = await sharp__WEBPACK_IMPORTED_MODULE_1___default()(fileBuffer).resize(1920, 1920, {\n            fit: \"inside\",\n            withoutEnlargement: true\n        }).jpeg({\n            quality: finalQuality,\n            progressive: true\n        }).toBuffer();\n        const compressedFile = new File([\n            compressedBuffer\n        ], file.name, {\n            type: \"image/jpeg\"\n        });\n        console.log(\"压缩前大小:\", (file.size / 1024 / 1024).toFixed(2) + \"MB\");\n        console.log(\"压缩后大小:\", (compressedFile.size / 1024 / 1024).toFixed(2) + \"MB\");\n        return compressedFile;\n    } catch (error) {\n        console.error(\"图片压缩失败:\", error);\n        return file;\n    }\n}\nasync function uploadToImageHub(file, retryCount = 0) {\n    try {\n        const formData = new FormData();\n        formData.append(\"source\", file);\n        const response = await fetch(process.env.IMAGEHUB_API_URL, {\n            method: \"POST\",\n            headers: {\n                \"X-API-Key\": process.env.IMAGEHUB_API_KEY\n            },\n            body: formData\n        });\n        if (!response.ok) {\n            throw new Error(\"图片上传失败\");\n        }\n        const result = await response.json();\n        console.log(\"图床上传响应:\", result);\n        if (result.status_code !== 200) {\n            throw new Error(result.status_txt || \"图片上传失败\");\n        }\n        return result.image.url;\n    } catch (error) {\n        if (retryCount < 2) {\n            console.log(`上传失败，尝试压缩后重新上传 (第${retryCount + 1}次)...`);\n            const compressedFile = await compressImage(file instanceof File ? file : new File([\n                file\n            ], \"image.jpg\"));\n            return uploadToImageHub(compressedFile, retryCount + 1);\n        }\n        throw error;\n    }\n}\nasync function downloadAndUploadImage(url) {\n    try {\n        console.log(\"开始下载图片:\", url);\n        const response = await fetch(url);\n        if (!response.ok) throw new Error(\"图片下载失败\");\n        const blob = await response.blob();\n        console.log(\"图片下载完成，开始上传到图床\");\n        return await uploadToImageHub(blob);\n    } catch (error) {\n        console.error(\"下载并上传图片失败:\", error);\n        throw error;\n    }\n}\nasync function POST(request) {\n    try {\n        // 1. 环境变量验证\n        const requiredEnvVars = [\n            \"WORKFLOW_ID\",\n            \"COZE_API_URL\",\n            \"AUTHORIZATION\",\n            \"IMAGEHUB_API_URL\",\n            \"IMAGEHUB_API_KEY\"\n        ];\n        const missingVars = requiredEnvVars.filter((key)=>!process.env[key]);\n        if (missingVars.length > 0) {\n            console.error(\"缺少环境变量:\", missingVars);\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                error: `配置错误: 缺少环境变量 ${missingVars.join(\", \")}`,\n                errorType: \"ConfigError\"\n            }), {\n                status: 500,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        // 2. 请求验证\n        const formData = await request.formData().catch((error)=>{\n            console.error(\"解析表单数据失败:\", error);\n            return null;\n        });\n        if (!formData) {\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                error: \"无效的请求数据\",\n                errorType: \"ValidationError\"\n            }), {\n                status: 400,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        const image1 = formData.get(\"image1\");\n        const image2 = formData.get(\"image2\");\n        if (!image1 || !image2) {\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                error: \"请提供两张图片\",\n                errorType: \"ValidationError\"\n            }), {\n                status: 400,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        // 3. 图片处理\n        try {\n            console.log(\"开始上传原始图片...\");\n            const [image1Url, image2Url] = await Promise.all([\n                uploadToImageHub(image1),\n                uploadToImageHub(image2)\n            ]);\n            // 4. 调用 Coze API\n            console.log(\"调用 Coze API...\");\n            const cozeResponse = await fetch(process.env.COZE_API_URL, {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Bearer ${process.env.AUTHORIZATION.trim()}`,\n                    \"Content-Type\": \"application/json\",\n                    \"Accept\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    workflow_id: process.env.WORKFLOW_ID.trim(),\n                    parameters: {\n                        face_image: image1Url,\n                        base_image: image2Url\n                    }\n                })\n            });\n            if (!cozeResponse.ok) {\n                const errorText = await cozeResponse.text();\n                console.error(\"Coze API 错误响应:\", errorText);\n                return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                    error: \"AI 处理失败\",\n                    errorType: \"CozeAPIError\",\n                    details: errorText\n                }), {\n                    status: 502,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            }\n            const cozeResult = await cozeResponse.json();\n            if (cozeResult.code !== 0) {\n                return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                    error: cozeResult.msg || \"AI 处理失败\",\n                    errorType: \"CozeAPIError\",\n                    details: cozeResult\n                }), {\n                    status: 502,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            }\n            // 5. 处理返回的图片\n            const outputData = typeof cozeResult.data === \"string\" ? JSON.parse(cozeResult.data) : cozeResult.data;\n            if (!outputData?.output) {\n                return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                    error: \"处理结果无效\",\n                    errorType: \"ProcessError\",\n                    details: cozeResult\n                }), {\n                    status: 500,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            }\n            // 6. 上传结果图片到图床\n            const finalImageUrl = await downloadAndUploadImage(outputData.output);\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                resultUrl: finalImageUrl,\n                originalUrl: outputData.output,\n                rawResponse: cozeResult\n            }), {\n                status: 200,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        } catch (error) {\n            console.error(\"处理过程错误:\", error);\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n                error: error instanceof Error ? error.message : \"处理失败\",\n                errorType: \"ProcessError\",\n                details: error instanceof Error ? error.stack : undefined\n            }), {\n                status: 500,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n    } catch (error) {\n        // 最外层错误处理\n        console.error(\"API 致命错误:\", error);\n        return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](JSON.stringify({\n            error: \"服务器内部错误\",\n            errorType: \"ServerError\",\n            details: error instanceof Error ? error.stack : undefined\n        }), {\n            status: 500,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL21lcmdlL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBdUQ7QUFDOUI7QUFFekIsZUFBZUUsY0FBY0MsSUFBVTtJQUNyQyxJQUFJO1FBQ0YsTUFBTUMsU0FBUyxNQUFNRCxLQUFLRSxXQUFXO1FBQ3JDLE1BQU1DLGFBQWFDLE9BQU9DLElBQUksQ0FBQ0o7UUFFL0IsTUFBTUssZ0JBQWdCLE9BQU9DLEtBQUtDLE1BQU0sS0FBTSxRQUFPLElBQUc7UUFDeEQsTUFBTUMsZUFBZUYsS0FBS0csS0FBSyxDQUFDLEtBQUtKO1FBRXJDSyxRQUFRQyxHQUFHLENBQUMsV0FBV04sY0FBY08sT0FBTyxDQUFDO1FBQzdDRixRQUFRQyxHQUFHLENBQUMsV0FBV0g7UUFFdkIsTUFBTUssbUJBQW1CLE1BQU1oQiw0Q0FBS0EsQ0FBQ0ssWUFDbENZLE1BQU0sQ0FBQyxNQUFNLE1BQU07WUFDbEJDLEtBQUs7WUFDTEMsb0JBQW9CO1FBQ3RCLEdBQ0NDLElBQUksQ0FBQztZQUNKQyxTQUFTVjtZQUNUVyxhQUFhO1FBQ2YsR0FDQ0MsUUFBUTtRQUVYLE1BQU1DLGlCQUFpQixJQUFJQyxLQUN6QjtZQUFDVDtTQUFpQixFQUNsQmQsS0FBS3dCLElBQUksRUFDVDtZQUFFQyxNQUFNO1FBQWE7UUFHdkJkLFFBQVFDLEdBQUcsQ0FBQyxVQUFVLENBQUNaLEtBQUswQixJQUFJLEdBQUcsT0FBTyxJQUFHLEVBQUdiLE9BQU8sQ0FBQyxLQUFLO1FBQzdERixRQUFRQyxHQUFHLENBQUMsVUFBVSxDQUFDVSxlQUFlSSxJQUFJLEdBQUcsT0FBTyxJQUFHLEVBQUdiLE9BQU8sQ0FBQyxLQUFLO1FBRXZFLE9BQU9TO0lBQ1QsRUFBRSxPQUFPSyxPQUFPO1FBQ2RoQixRQUFRZ0IsS0FBSyxDQUFDLFdBQVdBO1FBQ3pCLE9BQU8zQjtJQUNUO0FBQ0Y7QUFFQSxlQUFlNEIsaUJBQWlCNUIsSUFBaUIsRUFBRTZCLGFBQWEsQ0FBQztJQUMvRCxJQUFJO1FBQ0YsTUFBTUMsV0FBVyxJQUFJQztRQUNyQkQsU0FBU0UsTUFBTSxDQUFDLFVBQVVoQztRQUUxQixNQUFNaUMsV0FBVyxNQUFNQyxNQUFNQyxRQUFRQyxHQUFHLENBQUNDLGdCQUFnQixFQUFHO1lBQzFEQyxRQUFRO1lBQ1JDLFNBQVM7Z0JBQ1AsYUFBYUosUUFBUUMsR0FBRyxDQUFDSSxnQkFBZ0I7WUFDM0M7WUFDQUMsTUFBTVg7UUFDUjtRQUVBLElBQUksQ0FBQ0csU0FBU1MsRUFBRSxFQUFFO1lBQ2hCLE1BQU0sSUFBSUMsTUFBTTtRQUNsQjtRQUVBLE1BQU1DLFNBQVMsTUFBTVgsU0FBU1ksSUFBSTtRQUNsQ2xDLFFBQVFDLEdBQUcsQ0FBQyxXQUFXZ0M7UUFFdkIsSUFBSUEsT0FBT0UsV0FBVyxLQUFLLEtBQUs7WUFDOUIsTUFBTSxJQUFJSCxNQUFNQyxPQUFPRyxVQUFVLElBQUk7UUFDdkM7UUFFQSxPQUFPSCxPQUFPSSxLQUFLLENBQUNDLEdBQUc7SUFDekIsRUFBRSxPQUFPdEIsT0FBTztRQUNkLElBQUlFLGFBQWEsR0FBRztZQUNsQmxCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixFQUFFaUIsYUFBYSxFQUFFLEtBQUssQ0FBQztZQUNyRCxNQUFNUCxpQkFBaUIsTUFBTXZCLGNBQWNDLGdCQUFnQnVCLE9BQU92QixPQUFPLElBQUl1QixLQUFLO2dCQUFDdkI7YUFBSyxFQUFFO1lBQzFGLE9BQU80QixpQkFBaUJOLGdCQUFnQk8sYUFBYTtRQUN2RDtRQUNBLE1BQU1GO0lBQ1I7QUFDRjtBQUVBLGVBQWV1Qix1QkFBdUJELEdBQVc7SUFDL0MsSUFBSTtRQUNGdEMsUUFBUUMsR0FBRyxDQUFDLFdBQVdxQztRQUN2QixNQUFNaEIsV0FBVyxNQUFNQyxNQUFNZTtRQUM3QixJQUFJLENBQUNoQixTQUFTUyxFQUFFLEVBQUUsTUFBTSxJQUFJQyxNQUFNO1FBRWxDLE1BQU1RLE9BQU8sTUFBTWxCLFNBQVNrQixJQUFJO1FBQ2hDeEMsUUFBUUMsR0FBRyxDQUFDO1FBRVosT0FBTyxNQUFNZ0IsaUJBQWlCdUI7SUFDaEMsRUFBRSxPQUFPeEIsT0FBTztRQUNkaEIsUUFBUWdCLEtBQUssQ0FBQyxjQUFjQTtRQUM1QixNQUFNQTtJQUNSO0FBQ0Y7QUFFTyxlQUFleUIsS0FBS0MsT0FBb0I7SUFDN0MsSUFBSTtRQUNGLFlBQVk7UUFDWixNQUFNQyxrQkFBa0I7WUFDdEI7WUFDQTtZQUNBO1lBQ0E7WUFDQTtTQUNEO1FBRUQsTUFBTUMsY0FBY0QsZ0JBQWdCRSxNQUFNLENBQUNDLENBQUFBLE1BQU8sQ0FBQ3RCLFFBQVFDLEdBQUcsQ0FBQ3FCLElBQUk7UUFDbkUsSUFBSUYsWUFBWUcsTUFBTSxHQUFHLEdBQUc7WUFDMUIvQyxRQUFRZ0IsS0FBSyxDQUFDLFdBQVc0QjtZQUN6QixPQUFPLElBQUkxRCxrRkFBWUEsQ0FDckI4RCxLQUFLQyxTQUFTLENBQUM7Z0JBQ2JqQyxPQUFPLENBQUMsYUFBYSxFQUFFNEIsWUFBWU0sSUFBSSxDQUFDLE1BQU0sQ0FBQztnQkFDL0NDLFdBQVc7WUFDYixJQUNBO2dCQUNFQyxRQUFRO2dCQUNSeEIsU0FBUztvQkFBRSxnQkFBZ0I7Z0JBQW1CO1lBQ2hEO1FBRUo7UUFFQSxVQUFVO1FBQ1YsTUFBTVQsV0FBVyxNQUFNdUIsUUFBUXZCLFFBQVEsR0FBR2tDLEtBQUssQ0FBQ3JDLENBQUFBO1lBQzlDaEIsUUFBUWdCLEtBQUssQ0FBQyxhQUFhQTtZQUMzQixPQUFPO1FBQ1Q7UUFFQSxJQUFJLENBQUNHLFVBQVU7WUFDYixPQUFPLElBQUlqQyxrRkFBWUEsQ0FDckI4RCxLQUFLQyxTQUFTLENBQUM7Z0JBQ2JqQyxPQUFPO2dCQUNQbUMsV0FBVztZQUNiLElBQ0E7Z0JBQ0VDLFFBQVE7Z0JBQ1J4QixTQUFTO29CQUFFLGdCQUFnQjtnQkFBbUI7WUFDaEQ7UUFFSjtRQUVBLE1BQU0wQixTQUFTbkMsU0FBU29DLEdBQUcsQ0FBQztRQUM1QixNQUFNQyxTQUFTckMsU0FBU29DLEdBQUcsQ0FBQztRQUU1QixJQUFJLENBQUNELFVBQVUsQ0FBQ0UsUUFBUTtZQUN0QixPQUFPLElBQUl0RSxrRkFBWUEsQ0FDckI4RCxLQUFLQyxTQUFTLENBQUM7Z0JBQ2JqQyxPQUFPO2dCQUNQbUMsV0FBVztZQUNiLElBQ0E7Z0JBQ0VDLFFBQVE7Z0JBQ1J4QixTQUFTO29CQUFFLGdCQUFnQjtnQkFBbUI7WUFDaEQ7UUFFSjtRQUVBLFVBQVU7UUFDVixJQUFJO1lBQ0Y1QixRQUFRQyxHQUFHLENBQUM7WUFDWixNQUFNLENBQUN3RCxXQUFXQyxVQUFVLEdBQUcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDO2dCQUMvQzNDLGlCQUFpQnFDO2dCQUNqQnJDLGlCQUFpQnVDO2FBQ2xCO1lBRUQsaUJBQWlCO1lBQ2pCeEQsUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTTRELGVBQWUsTUFBTXRDLE1BQU1DLFFBQVFDLEdBQUcsQ0FBQ3FDLFlBQVksRUFBRztnQkFDMURuQyxRQUFRO2dCQUNSQyxTQUFTO29CQUNQLGlCQUFpQixDQUFDLE9BQU8sRUFBRUosUUFBUUMsR0FBRyxDQUFDc0MsYUFBYSxDQUFFQyxJQUFJLEdBQUcsQ0FBQztvQkFDOUQsZ0JBQWdCO29CQUNoQixVQUFVO2dCQUNaO2dCQUNBbEMsTUFBTWtCLEtBQUtDLFNBQVMsQ0FBQztvQkFDbkJnQixhQUFhekMsUUFBUUMsR0FBRyxDQUFDeUMsV0FBVyxDQUFFRixJQUFJO29CQUMxQ0csWUFBWTt3QkFBRUMsWUFBWVg7d0JBQVdZLFlBQVlYO29CQUFVO2dCQUM3RDtZQUNGO1lBRUEsSUFBSSxDQUFDRyxhQUFhOUIsRUFBRSxFQUFFO2dCQUNwQixNQUFNdUMsWUFBWSxNQUFNVCxhQUFhVSxJQUFJO2dCQUN6Q3ZFLFFBQVFnQixLQUFLLENBQUMsa0JBQWtCc0Q7Z0JBQ2hDLE9BQU8sSUFBSXBGLGtGQUFZQSxDQUNyQjhELEtBQUtDLFNBQVMsQ0FBQztvQkFDYmpDLE9BQU87b0JBQ1BtQyxXQUFXO29CQUNYcUIsU0FBU0Y7Z0JBQ1gsSUFDQTtvQkFDRWxCLFFBQVE7b0JBQ1J4QixTQUFTO3dCQUFFLGdCQUFnQjtvQkFBbUI7Z0JBQ2hEO1lBRUo7WUFFQSxNQUFNNkMsYUFBYSxNQUFNWixhQUFhM0IsSUFBSTtZQUUxQyxJQUFJdUMsV0FBV0MsSUFBSSxLQUFLLEdBQUc7Z0JBQ3pCLE9BQU8sSUFBSXhGLGtGQUFZQSxDQUNyQjhELEtBQUtDLFNBQVMsQ0FBQztvQkFDYmpDLE9BQU95RCxXQUFXRSxHQUFHLElBQUk7b0JBQ3pCeEIsV0FBVztvQkFDWHFCLFNBQVNDO2dCQUNYLElBQ0E7b0JBQ0VyQixRQUFRO29CQUNSeEIsU0FBUzt3QkFBRSxnQkFBZ0I7b0JBQW1CO2dCQUNoRDtZQUVKO1lBRUEsYUFBYTtZQUNiLE1BQU1nRCxhQUFhLE9BQU9ILFdBQVdJLElBQUksS0FBSyxXQUMxQzdCLEtBQUs4QixLQUFLLENBQUNMLFdBQVdJLElBQUksSUFDMUJKLFdBQVdJLElBQUk7WUFFbkIsSUFBSSxDQUFDRCxZQUFZRyxRQUFRO2dCQUN2QixPQUFPLElBQUk3RixrRkFBWUEsQ0FDckI4RCxLQUFLQyxTQUFTLENBQUM7b0JBQ2JqQyxPQUFPO29CQUNQbUMsV0FBVztvQkFDWHFCLFNBQVNDO2dCQUNYLElBQ0E7b0JBQ0VyQixRQUFRO29CQUNSeEIsU0FBUzt3QkFBRSxnQkFBZ0I7b0JBQW1CO2dCQUNoRDtZQUVKO1lBRUEsZUFBZTtZQUNmLE1BQU1vRCxnQkFBZ0IsTUFBTXpDLHVCQUF1QnFDLFdBQVdHLE1BQU07WUFFcEUsT0FBTyxJQUFJN0Ysa0ZBQVlBLENBQ3JCOEQsS0FBS0MsU0FBUyxDQUFDO2dCQUNiZ0MsV0FBV0Q7Z0JBQ1hFLGFBQWFOLFdBQVdHLE1BQU07Z0JBQzlCSSxhQUFhVjtZQUNmLElBQ0E7Z0JBQ0VyQixRQUFRO2dCQUNSeEIsU0FBUztvQkFBRSxnQkFBZ0I7Z0JBQW1CO1lBQ2hEO1FBR0osRUFBRSxPQUFPWixPQUFPO1lBQ2RoQixRQUFRZ0IsS0FBSyxDQUFDLFdBQVdBO1lBQ3pCLE9BQU8sSUFBSTlCLGtGQUFZQSxDQUNyQjhELEtBQUtDLFNBQVMsQ0FBQztnQkFDYmpDLE9BQU9BLGlCQUFpQmdCLFFBQVFoQixNQUFNb0UsT0FBTyxHQUFHO2dCQUNoRGpDLFdBQVc7Z0JBQ1hxQixTQUFTeEQsaUJBQWlCZ0IsUUFBUWhCLE1BQU1xRSxLQUFLLEdBQUdDO1lBQ2xELElBQ0E7Z0JBQ0VsQyxRQUFRO2dCQUNSeEIsU0FBUztvQkFBRSxnQkFBZ0I7Z0JBQW1CO1lBQ2hEO1FBRUo7SUFFRixFQUFFLE9BQU9aLE9BQU87UUFDZCxVQUFVO1FBQ1ZoQixRQUFRZ0IsS0FBSyxDQUFDLGFBQWFBO1FBQzNCLE9BQU8sSUFBSTlCLGtGQUFZQSxDQUNyQjhELEtBQUtDLFNBQVMsQ0FBQztZQUNiakMsT0FBTztZQUNQbUMsV0FBVztZQUNYcUIsU0FBU3hELGlCQUFpQmdCLFFBQVFoQixNQUFNcUUsS0FBSyxHQUFHQztRQUNsRCxJQUNBO1lBQ0VsQyxRQUFRO1lBQ1J4QixTQUFTO2dCQUFFLGdCQUFnQjtZQUFtQjtRQUNoRDtJQUVKO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mYWNlLXN3YXAtYXBwLy4vYXBwL2FwaS9tZXJnZS9yb3V0ZS50cz82NTc4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHNoYXJwIGZyb20gJ3NoYXJwJ1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gY29tcHJlc3NJbWFnZShmaWxlOiBGaWxlKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKVxyXG4gICAgY29uc3QgZmlsZUJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGJ1ZmZlcilcclxuXHJcbiAgICBjb25zdCByYW5kb21RdWFsaXR5ID0gMC41OSArIE1hdGgucmFuZG9tKCkgKiAoMC45OSAtIDAuNTkpXHJcbiAgICBjb25zdCBmaW5hbFF1YWxpdHkgPSBNYXRoLmZsb29yKDgwICogcmFuZG9tUXVhbGl0eSlcclxuXHJcbiAgICBjb25zb2xlLmxvZygn5Y6L57yp6LSo6YeP57O75pWwOicsIHJhbmRvbVF1YWxpdHkudG9GaXhlZCg2KSlcclxuICAgIGNvbnNvbGUubG9nKCfmnIDnu4jljovnvKnotKjph486JywgZmluYWxRdWFsaXR5KVxyXG5cclxuICAgIGNvbnN0IGNvbXByZXNzZWRCdWZmZXIgPSBhd2FpdCBzaGFycChmaWxlQnVmZmVyKVxyXG4gICAgICAucmVzaXplKDE5MjAsIDE5MjAsIHtcclxuICAgICAgICBmaXQ6ICdpbnNpZGUnLFxyXG4gICAgICAgIHdpdGhvdXRFbmxhcmdlbWVudDogdHJ1ZVxyXG4gICAgICB9KVxyXG4gICAgICAuanBlZyh7XHJcbiAgICAgICAgcXVhbGl0eTogZmluYWxRdWFsaXR5LFxyXG4gICAgICAgIHByb2dyZXNzaXZlOiB0cnVlXHJcbiAgICAgIH0pXHJcbiAgICAgIC50b0J1ZmZlcigpXHJcblxyXG4gICAgY29uc3QgY29tcHJlc3NlZEZpbGUgPSBuZXcgRmlsZShcclxuICAgICAgW2NvbXByZXNzZWRCdWZmZXJdLFxyXG4gICAgICBmaWxlLm5hbWUsXHJcbiAgICAgIHsgdHlwZTogJ2ltYWdlL2pwZWcnIH1cclxuICAgIClcclxuXHJcbiAgICBjb25zb2xlLmxvZygn5Y6L57yp5YmN5aSn5bCPOicsIChmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCkudG9GaXhlZCgyKSArICdNQicpXHJcbiAgICBjb25zb2xlLmxvZygn5Y6L57yp5ZCO5aSn5bCPOicsIChjb21wcmVzc2VkRmlsZS5zaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMikgKyAnTUInKVxyXG5cclxuICAgIHJldHVybiBjb21wcmVzc2VkRmlsZVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCflm77niYfljovnvKnlpLHotKU6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gZmlsZVxyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gdXBsb2FkVG9JbWFnZUh1YihmaWxlOiBGaWxlIHwgQmxvYiwgcmV0cnlDb3VudCA9IDApOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpXHJcbiAgICBmb3JtRGF0YS5hcHBlbmQoJ3NvdXJjZScsIGZpbGUpXHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChwcm9jZXNzLmVudi5JTUFHRUhVQl9BUElfVVJMISwge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdYLUFQSS1LZXknOiBwcm9jZXNzLmVudi5JTUFHRUhVQl9BUElfS0VZISxcclxuICAgICAgfSxcclxuICAgICAgYm9keTogZm9ybURhdGFcclxuICAgIH0pXHJcblxyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+WbvueJh+S4iuS8oOWksei0pScpXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXHJcbiAgICBjb25zb2xlLmxvZygn5Zu+5bqK5LiK5Lyg5ZON5bqUOicsIHJlc3VsdClcclxuXHJcbiAgICBpZiAocmVzdWx0LnN0YXR1c19jb2RlICE9PSAyMDApIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3VsdC5zdGF0dXNfdHh0IHx8ICflm77niYfkuIrkvKDlpLHotKUnKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHQuaW1hZ2UudXJsXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGlmIChyZXRyeUNvdW50IDwgMikge1xyXG4gICAgICBjb25zb2xlLmxvZyhg5LiK5Lyg5aSx6LSl77yM5bCd6K+V5Y6L57yp5ZCO6YeN5paw5LiK5LygICjnrKwke3JldHJ5Q291bnQgKyAxfeasoSkuLi5gKVxyXG4gICAgICBjb25zdCBjb21wcmVzc2VkRmlsZSA9IGF3YWl0IGNvbXByZXNzSW1hZ2UoZmlsZSBpbnN0YW5jZW9mIEZpbGUgPyBmaWxlIDogbmV3IEZpbGUoW2ZpbGVdLCAnaW1hZ2UuanBnJykpXHJcbiAgICAgIHJldHVybiB1cGxvYWRUb0ltYWdlSHViKGNvbXByZXNzZWRGaWxlLCByZXRyeUNvdW50ICsgMSlcclxuICAgIH1cclxuICAgIHRocm93IGVycm9yXHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBkb3dubG9hZEFuZFVwbG9hZEltYWdlKHVybDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJ+W8gOWni+S4i+i9veWbvueJhzonLCB1cmwpXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybClcclxuICAgIGlmICghcmVzcG9uc2Uub2spIHRocm93IG5ldyBFcnJvcign5Zu+54mH5LiL6L295aSx6LSlJylcclxuICAgIFxyXG4gICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKVxyXG4gICAgY29uc29sZS5sb2coJ+WbvueJh+S4i+i9veWujOaIkO+8jOW8gOWni+S4iuS8oOWIsOWbvuW6iicpXHJcbiAgICBcclxuICAgIHJldHVybiBhd2FpdCB1cGxvYWRUb0ltYWdlSHViKGJsb2IpXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+S4i+i9veW5tuS4iuS8oOWbvueJh+Wksei0pTonLCBlcnJvcilcclxuICAgIHRocm93IGVycm9yXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyAxLiDnjq/looPlj5jph4/pqozor4FcclxuICAgIGNvbnN0IHJlcXVpcmVkRW52VmFycyA9IFtcclxuICAgICAgJ1dPUktGTE9XX0lEJyxcclxuICAgICAgJ0NPWkVfQVBJX1VSTCcsXHJcbiAgICAgICdBVVRIT1JJWkFUSU9OJyxcclxuICAgICAgJ0lNQUdFSFVCX0FQSV9VUkwnLFxyXG4gICAgICAnSU1BR0VIVUJfQVBJX0tFWSdcclxuICAgIF1cclxuICAgIFxyXG4gICAgY29uc3QgbWlzc2luZ1ZhcnMgPSByZXF1aXJlZEVudlZhcnMuZmlsdGVyKGtleSA9PiAhcHJvY2Vzcy5lbnZba2V5XSlcclxuICAgIGlmIChtaXNzaW5nVmFycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+e8uuWwkeeOr+Wig+WPmOmHjzonLCBtaXNzaW5nVmFycylcclxuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoXHJcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgZXJyb3I6IGDphY3nva7plJnor686IOe8uuWwkeeOr+Wig+WPmOmHjyAke21pc3NpbmdWYXJzLmpvaW4oJywgJyl9YCxcclxuICAgICAgICAgIGVycm9yVHlwZTogJ0NvbmZpZ0Vycm9yJ1xyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHN0YXR1czogNTAwLFxyXG4gICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cclxuICAgICAgICB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyAyLiDor7fmsYLpqozor4FcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gYXdhaXQgcmVxdWVzdC5mb3JtRGF0YSgpLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcign6Kej5p6Q6KGo5Y2V5pWw5o2u5aSx6LSlOicsIGVycm9yKVxyXG4gICAgICByZXR1cm4gbnVsbFxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoIWZvcm1EYXRhKSB7XHJcbiAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIGVycm9yOiAn5peg5pWI55qE6K+35rGC5pWw5o2uJyxcclxuICAgICAgICAgIGVycm9yVHlwZTogJ1ZhbGlkYXRpb25FcnJvcidcclxuICAgICAgICB9KSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdGF0dXM6IDQwMCxcclxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgICAgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaW1hZ2UxID0gZm9ybURhdGEuZ2V0KCdpbWFnZTEnKSBhcyBGaWxlXHJcbiAgICBjb25zdCBpbWFnZTIgPSBmb3JtRGF0YS5nZXQoJ2ltYWdlMicpIGFzIEZpbGVcclxuXHJcbiAgICBpZiAoIWltYWdlMSB8fCAhaW1hZ2UyKSB7XHJcbiAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIGVycm9yOiAn6K+35o+Q5L6b5Lik5byg5Zu+54mHJyxcclxuICAgICAgICAgIGVycm9yVHlwZTogJ1ZhbGlkYXRpb25FcnJvcidcclxuICAgICAgICB9KSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzdGF0dXM6IDQwMCxcclxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgICAgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gMy4g5Zu+54mH5aSE55CGXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZygn5byA5aeL5LiK5Lyg5Y6f5aeL5Zu+54mHLi4uJylcclxuICAgICAgY29uc3QgW2ltYWdlMVVybCwgaW1hZ2UyVXJsXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgICB1cGxvYWRUb0ltYWdlSHViKGltYWdlMSksXHJcbiAgICAgICAgdXBsb2FkVG9JbWFnZUh1YihpbWFnZTIpXHJcbiAgICAgIF0pXHJcblxyXG4gICAgICAvLyA0LiDosIPnlKggQ296ZSBBUElcclxuICAgICAgY29uc29sZS5sb2coJ+iwg+eUqCBDb3plIEFQSS4uLicpXHJcbiAgICAgIGNvbnN0IGNvemVSZXNwb25zZSA9IGF3YWl0IGZldGNoKHByb2Nlc3MuZW52LkNPWkVfQVBJX1VSTCEsIHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtwcm9jZXNzLmVudi5BVVRIT1JJWkFUSU9OIS50cmltKCl9YCxcclxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICB3b3JrZmxvd19pZDogcHJvY2Vzcy5lbnYuV09SS0ZMT1dfSUQhLnRyaW0oKSxcclxuICAgICAgICAgIHBhcmFtZXRlcnM6IHsgZmFjZV9pbWFnZTogaW1hZ2UxVXJsLCBiYXNlX2ltYWdlOiBpbWFnZTJVcmwgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICBpZiAoIWNvemVSZXNwb25zZS5vaykge1xyXG4gICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IGNvemVSZXNwb25zZS50ZXh0KClcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdDb3plIEFQSSDplJnor6/lk43lupQ6JywgZXJyb3JUZXh0KVxyXG4gICAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBlcnJvcjogJ0FJIOWkhOeQhuWksei0pScsXHJcbiAgICAgICAgICAgIGVycm9yVHlwZTogJ0NvemVBUElFcnJvcicsXHJcbiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yVGV4dFxyXG4gICAgICAgICAgfSksXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHN0YXR1czogNTAyLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgY296ZVJlc3VsdCA9IGF3YWl0IGNvemVSZXNwb25zZS5qc29uKClcclxuICAgICAgXHJcbiAgICAgIGlmIChjb3plUmVzdWx0LmNvZGUgIT09IDApIHtcclxuICAgICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShcclxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgZXJyb3I6IGNvemVSZXN1bHQubXNnIHx8ICdBSSDlpITnkIblpLHotKUnLFxyXG4gICAgICAgICAgICBlcnJvclR5cGU6ICdDb3plQVBJRXJyb3InLFxyXG4gICAgICAgICAgICBkZXRhaWxzOiBjb3plUmVzdWx0XHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgc3RhdHVzOiA1MDIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyA1LiDlpITnkIbov5Tlm57nmoTlm77niYdcclxuICAgICAgY29uc3Qgb3V0cHV0RGF0YSA9IHR5cGVvZiBjb3plUmVzdWx0LmRhdGEgPT09ICdzdHJpbmcnIFxyXG4gICAgICAgID8gSlNPTi5wYXJzZShjb3plUmVzdWx0LmRhdGEpIFxyXG4gICAgICAgIDogY296ZVJlc3VsdC5kYXRhXHJcblxyXG4gICAgICBpZiAoIW91dHB1dERhdGE/Lm91dHB1dCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBlcnJvcjogJ+WkhOeQhue7k+aenOaXoOaViCcsXHJcbiAgICAgICAgICAgIGVycm9yVHlwZTogJ1Byb2Nlc3NFcnJvcicsXHJcbiAgICAgICAgICAgIGRldGFpbHM6IGNvemVSZXN1bHRcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBzdGF0dXM6IDUwMCxcclxuICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICApXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIDYuIOS4iuS8oOe7k+aenOWbvueJh+WIsOWbvuW6ilxyXG4gICAgICBjb25zdCBmaW5hbEltYWdlVXJsID0gYXdhaXQgZG93bmxvYWRBbmRVcGxvYWRJbWFnZShvdXRwdXREYXRhLm91dHB1dClcclxuXHJcbiAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxyXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIHJlc3VsdFVybDogZmluYWxJbWFnZVVybCxcclxuICAgICAgICAgIG9yaWdpbmFsVXJsOiBvdXRwdXREYXRhLm91dHB1dCxcclxuICAgICAgICAgIHJhd1Jlc3BvbnNlOiBjb3plUmVzdWx0XHJcbiAgICAgICAgfSksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc3RhdHVzOiAyMDAsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxyXG4gICAgICAgIH1cclxuICAgICAgKVxyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+WkhOeQhui/h+eoi+mUmeivrzonLCBlcnJvcilcclxuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoXHJcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+WkhOeQhuWksei0pScsXHJcbiAgICAgICAgICBlcnJvclR5cGU6ICdQcm9jZXNzRXJyb3InLFxyXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogdW5kZWZpbmVkXHJcbiAgICAgICAgfSksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc3RhdHVzOiA1MDAsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxyXG4gICAgICAgIH1cclxuICAgICAgKVxyXG4gICAgfVxyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgLy8g5pyA5aSW5bGC6ZSZ6K+v5aSE55CGXHJcbiAgICBjb25zb2xlLmVycm9yKCdBUEkg6Ie05ZG96ZSZ6K+vOicsIGVycm9yKVxyXG4gICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoXHJcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBlcnJvcjogJ+acjeWKoeWZqOWGhemDqOmUmeivrycsXHJcbiAgICAgICAgZXJyb3JUeXBlOiAnU2VydmVyRXJyb3InLFxyXG4gICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6IHVuZGVmaW5lZFxyXG4gICAgICB9KSxcclxuICAgICAge1xyXG4gICAgICAgIHN0YXR1czogNTAwLFxyXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XHJcbiAgICAgIH1cclxuICAgIClcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInNoYXJwIiwiY29tcHJlc3NJbWFnZSIsImZpbGUiLCJidWZmZXIiLCJhcnJheUJ1ZmZlciIsImZpbGVCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwicmFuZG9tUXVhbGl0eSIsIk1hdGgiLCJyYW5kb20iLCJmaW5hbFF1YWxpdHkiLCJmbG9vciIsImNvbnNvbGUiLCJsb2ciLCJ0b0ZpeGVkIiwiY29tcHJlc3NlZEJ1ZmZlciIsInJlc2l6ZSIsImZpdCIsIndpdGhvdXRFbmxhcmdlbWVudCIsImpwZWciLCJxdWFsaXR5IiwicHJvZ3Jlc3NpdmUiLCJ0b0J1ZmZlciIsImNvbXByZXNzZWRGaWxlIiwiRmlsZSIsIm5hbWUiLCJ0eXBlIiwic2l6ZSIsImVycm9yIiwidXBsb2FkVG9JbWFnZUh1YiIsInJldHJ5Q291bnQiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwicmVzcG9uc2UiLCJmZXRjaCIsInByb2Nlc3MiLCJlbnYiLCJJTUFHRUhVQl9BUElfVVJMIiwibWV0aG9kIiwiaGVhZGVycyIsIklNQUdFSFVCX0FQSV9LRVkiLCJib2R5Iiwib2siLCJFcnJvciIsInJlc3VsdCIsImpzb24iLCJzdGF0dXNfY29kZSIsInN0YXR1c190eHQiLCJpbWFnZSIsInVybCIsImRvd25sb2FkQW5kVXBsb2FkSW1hZ2UiLCJibG9iIiwiUE9TVCIsInJlcXVlc3QiLCJyZXF1aXJlZEVudlZhcnMiLCJtaXNzaW5nVmFycyIsImZpbHRlciIsImtleSIsImxlbmd0aCIsIkpTT04iLCJzdHJpbmdpZnkiLCJqb2luIiwiZXJyb3JUeXBlIiwic3RhdHVzIiwiY2F0Y2giLCJpbWFnZTEiLCJnZXQiLCJpbWFnZTIiLCJpbWFnZTFVcmwiLCJpbWFnZTJVcmwiLCJQcm9taXNlIiwiYWxsIiwiY296ZVJlc3BvbnNlIiwiQ09aRV9BUElfVVJMIiwiQVVUSE9SSVpBVElPTiIsInRyaW0iLCJ3b3JrZmxvd19pZCIsIldPUktGTE9XX0lEIiwicGFyYW1ldGVycyIsImZhY2VfaW1hZ2UiLCJiYXNlX2ltYWdlIiwiZXJyb3JUZXh0IiwidGV4dCIsImRldGFpbHMiLCJjb3plUmVzdWx0IiwiY29kZSIsIm1zZyIsIm91dHB1dERhdGEiLCJkYXRhIiwicGFyc2UiLCJvdXRwdXQiLCJmaW5hbEltYWdlVXJsIiwicmVzdWx0VXJsIiwib3JpZ2luYWxVcmwiLCJyYXdSZXNwb25zZSIsIm1lc3NhZ2UiLCJzdGFjayIsInVuZGVmaW5lZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/merge/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmerge%2Froute&page=%2Fapi%2Fmerge%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmerge%2Froute.ts&appDir=D%3A%5CCursor%5Cface2exchange%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCursor%5Cface2exchange&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();